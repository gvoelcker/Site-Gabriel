---
output: html_document
---

# 14.121 - Microeconomic Theory I{.tabset}

## **The Course**{.tabset}

### **Overview of The Course**

14.121 is structured in 7 Lectures:

1) The first lecture deals with **utility** and **revealed preferences**. This is useful for modelling how individuals make decisions. We use a **utility function** to model the preferences of a consumer. This utility implies that preferences are complete, reflexive and transitive. **Revealed preferences** are the choices a consumer makes when confronted with different bundles. If x is chosen when y could have been chosen, then x is **directly revealed preferred** to y. 

2) Having constructed these basic notions we advance to **Demand Theory**, our second lecture. We assume that the consumer is trying to **maximize his utility**. In order to do that, he defines his **budget set** given his wealth, and then we use this information to assess his **Utility Maximization Problem**. Knowing what his demand will be, we can figure out what his **Walrasian Demand Correspondence** is. From this information we derive elasticities and other interesting information about the UMP. Then we advance to the **indirect utility functions**, that maximize the utility given certain prices and wealth. On the other side of all we've seen in this lecture so far, we've got the **Expenditure Minimization Problem(EMP)**. As the name implies, this problem seeks to find the minimum a consumer can spend in order to achieve a certain level of utility. Just as we have the Walrasian Demand Correspondence for the UMP, for the EMP we have the **Hicksian Demand Correspondence**. We advance some concepts and find out some (obvious) ideas like when prices go up, demand for the product goes down. Then we advance to some technical stuff like Slutsky's matrix and Roy's Identity.

3) On our third lecture we will put consumer to work by tackling how it deals with 7 main ideas:

    i) Price changes and welfare: when prices changes, what happens to the welfare of people? If the utility lowers $\rightarrow$ the consumer is worse off. But how do we **measure welfare**? There are 2 main ways: 1) **Equivalent Variation**(EV): how much money would compensate the change in utility?; 2) **Compensating Variation(CV)**: given that the prices have changed, how much the consumer would need to be paid to be as well off?
    
    ii) Welfare from new goods: what happens if a new good comes in or an old one is gone? 3 scenarios: 1) no income effects on demand; 2) Non-parametrically go from Marshallian to Hicksian; 3) Convert from Marshallian to Hicksian via functional form assumption. 
    
    iii) Price indexes: is an important measure of welfare change. Two most common: 1) **Laspeyres**: holds consumption from the first period; 2) **Paasche**: holds consumption from the second period.
    
    iv) Choosing functional forms: we choose simpler functions! 1) **Restrict preferences**: maes the demand within a group of goods to be independent of prices outside of that group; 2) **Restrict price movements**: assumes that the prices within a group move proportionally. 
    
    v) Integrability: allows us to make sure the consumer demand corresponds to a particular utility maximization.
    
    vi) Estimating demand: there are two main ways to estimate demand: 1) **Products as primitives**: Audi ≠ Toyota ≠ Honda; 2) **Characteristics as primitives**: size ≠ horse power. This goes deep, please see the lecture notes below.
    
    vii) Demand aggregation: we're not talking about a single consumer anymore, but about the aggregate demand. This is when the **representative consumer** comes into play. When aggregate demand is independent of the wealth distribution, we can use the **Gorman Form**.
    
4) After three lectures looking into the consumer's side, let's turn our attention to the Producer. Analogously to the consumer, the firm faces the **Profit Maximization Problem** and the **Cost Minimization Problem**. We get a grasp of the main concepts regarding the firm's side. The **production set** is the set of all possible production activities a firm can undertake. The **Marginal Rate of Transformation** calculates how much more of a good L you can produce when you produce one less unit of product K. The **Marginal Rate of Substitution** calculates how much more of a good K you need to maintain the level of output given that you are producing one less unit of good L. Then we approach subjects like **Increasing Differences** and **Supermodularity**. The fun part is that there are some applications to producer theory. For example: 1) How does the capital choice relate to prices in cost minimization problems? 2) What are the cross price effects in the PMP? When are goods substitutes? When are they complements? Going forward, we also study the **Cobb-Douglas function**. Also, we address Statics(please see more below). One (maybe) assumption we make is that prices are uncorrelated to the quantity produced. Let's change to a **monopolistic** setting in which this is not true. How can we correlate this to the **Law of Supply**? $\rightarrow$ quantitites respond in the same direction as price changes. 

5) We've studied so far the two sides of the market: Supply(Producer) and Demand(Consumer). Now let's look to the outsiders: Externalities. This happens when the well-being of a consumer/producer is affected directly by another agent in the economy. When these are present, **market failures** may arise and we will need government intervention. Starting from a simple model of externalities: two-agents, the first plays music loud and disturbs the second. How do we allocate their indirect utilities in order to maximize them, given that one interferes with the other? Let's think this from a **Pareto Optimal** perspective: how can we allocate things such that no agent can be better off without hurting the other? The PO maximize the joint surplus of both consumers, which doesn't mean that the externality is eliminated $\implies$ the benefit of an extra unit of the externality to agent 1 is equal to the cost of an extra unit of it to agent 2. What if the way to restore efficiency is through **government intervention**? This can be done through a **quota** or a **tax**(👎). [**Coase**](https://en.wikipedia.org/wiki/Ronald_Coase) pointed how an externality arose from two factors: 1) lack of clearly specified property rights; 2) transaction costs. This was stated in the following theorem: if property rights are clearly specified and there are no transaction costs, bargaining will lead to an efficient outcome no matter how the rights are allocated. However, we have the [**Anti-Coase Theorem**](https://en.wikipedia.org/wiki/Myerson%E2%80%93Satterthwaite_theorem), proposed by [**Myerson**](https://en.wikipedia.org/wiki/Roger_Myerson)-[**Satterthwaite**](https://en.wikipedia.org/wiki/Mark_Satterthwaite): *no bargaining procedure can lead to an efficient outcome for all values of b and s when they are private information and independently distributed*. Anyway, there's a lot of discussion in whether we should regulate externalities or not, but that depends on a lot of factors. Are there market for externalities? Can we directly measure them? Should we regulate on price or quantity?

6) How do these market players interact? Let's try and draw the big picture: [**General Equilibrium**](https://en.wikipedia.org/wiki/General_equilibrium_theory). A **Walrasian Equilibrium** depends on 3 factors: 1) are the agents maximizing their utilities?; 2) are markets clearing? 3) is the allocation feasible? In terms of welfare, we care if the GE is Pareto Optimal, such that no agent can be better off without hurting another. We use a 2x2 economy as the setting. Given the number of agents(2), commodities (2), the consumption vector and the endowments, we use the [**Edgeworth Box**](https://en.wikipedia.org/wiki/Edgeworth_box) to represent the distribution of resources. This deals with budget set, offer curve, excess demand, pareto set and contract curve. From that we evolve to the [**First Welfare Theorem**](https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics#Implications_of_the_first_theorem): when markets are complete, any competitive equilibrium is necessarily Pareto optimal(in other words: once we find an efficient allocation, we could support it with a price equilibrium $\rightarrow$ any Walrasian Equilibrium is PAreto Optimal). Then the [**Second Welfare Theorem**](https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics#Proof_of_the_second_fundamental_theorem): any Pareto optimal can be achieved as a competitive equilibrium if appropriate lump-sum transfers of wealth are arranged. We use the Kuhn-Tucker FOC to find equilibrium(?). And also the FOC can provide a way to link Pareto optimal allocations to Walrasian equilibria. Then we incorporate production into the picture: the Robinson Crusoe model. After that, we advance to a 2x2 Production Economy. Then, we talk about **Public Goods**: when an agent consumes them, another's consumption of them is not affected. **Free-riding** problem: given that there is under-provision of the good, people rides on every else's provision. [**Lindahl Equilibrium**](https://www.investopedia.com/terms/l/lindahl-equilibrium.asp): proposes that the individual pays ofor a personalized price to determine an efficient level of provision for public goods. Since market mechanisms are unlikely to provide public goods efficiently we have reason to have government involvement.  

7) We have arrived on the final lecture of the course: Existence and Other Properties! We check for the existence of a Walrasian Equilibrium using Brouwer's Theorem. We also use Kakutani's Fixed Point theorem to test for the existence of equilibrium. Walras' Law allows us to check market clearing in L - 1 markets. Also, in GE we have some properties of the set of equilibrium prices: z(p) = 0: i) relative prices are determined; ii) only need to check market clearing in L - 1 markets; iii) z is homogeneous of degree 0. In equilibrium, the price vector is **regular** if the Jacobian Matrix has rank L - 1. This regularity condition is key for **comparative statics**. This leads us to questions such as: how do price changes with changes in endowment? In Walrasian Equilibrium, we look for a price vector that is **locally unique** such that: i) any regular equilibrium is locally unique; ii) a regular economy has a finite number of equilibria; iii) for almost every vector of initial endowments, the exchange economy is regular. We then advance to the Sonnenschein-Mantel-Debreu Theorem. How do we interpret that? 1) "Too much freedom"; 2) Why look only at excess demand functions?

### **1) Utility And Revealed Preferences**

#### Intro

Our first [**lecture**](https://gabrielvoelcker.netlify.com/mit/14121lecture1.pdf) deals with [**Utility Theory**](https://en.wikipedia.org/wiki/Utility) and [**Revealed Preferences**](https://en.wikipedia.org/wiki/Utility#Revealed_preference). We use an axiomatic approach. It was recognized that utility could not be measured or observed directly, so instead economists devised a way to infer underlying relative utilities from observed choice.

#### Utility Theory

In Economics, the concept of utility is used to model worth/value. In most economic models, agents are assumed to have a utility function that they maximize. The utility function approach usually serves [**two purposes**](https://www.investopedia.com/ask/answers/12/difference-between-positive-normative-economics.asp):

1) **Positive**: this is the “what is” approach. This is most commonly used (95%).

2) **Normative**: “what should happen” approach.

If we reflect about this utility approach, we have an opportunity to introduce one useful economic methodology: the axiomatic approach.

#### Axiomatic Approach

A theory consists of an axiomatic system and all its derived theorems. The idea is to find simple axioms which together are equivalent to less obvious assumptions of utility theory. 

#### Utility Function

A **utility function** represents a consumer’s preference ordering over a choice set. Consider a set of alternatives facing an individual, and over which the individual has a preference ordering. A utility function is able to represent those preferences if it is possible to assign a real number to each alternative, in such a way that alternative a is assigned a number greater than alternative b if, and only if, the individual prefers alternative a to alternative b. In this situation an individual that selects the most preferred alternative available is necessarily also selecting the alternative that maximises the associated utility function. In general economic terms, a utility function measures preferences concerning a set of goods and services. Often, utility is correlated with words such as happiness, satisfaction, and welfare, and these are hard to measure mathematically. Thus, economists utilize consumption baskets of preferences in order to measure these abstract, non quantifiable ideas.

**Utility Definition**: *u* defined on *X* is a real-valued function u: X $\rightarrow$ $\mathbb{R}$. 

**Preference Definition**: x $\succeq_p$ y means "x is at least as good as y". 

How do we link the utility and preference? Well, the **utility function** *u* is representative of the **preference** *P* if, for u: X $\rightarrow$ $\mathbb{R}$, we have that 

\[ u(x) ≥ u(y) \iff x \succeq_p y \]

This means that when x is at least as good as y in terms of preferences, then the decision-maker will derive at least the same amount of utility of x as he/she does from y. 

##### **Properties of Preferences**:

- The preference relation $\succeq_P$ is **complete** on *X* if $\forall$*x*, *y* $\in$ *X*, either *x* $\succeq_P$ *y* or *y* $\succeq_P$ *x*.

- The preference relation $\succeq_P$ is **reflexive** on *X* if $\forall$*x* $\in$ *X*, *x* $\succeq_P$ *x*.

- The preference relation $\succeq_P$ is **transitive** on *X* if *x* $\succeq_P$ *y* and *y* $\succeq_P$ *z* $\implies$ *x* $\succeq_P$ *z*.

Our first result is the following **proposition**: if $\succeq_P$ is represented by *u* on *X*, then $\succeq_P$ is complete, reflexive and transitive. By assuming these properties we establish a cohesive starting point to model microeconomics, given that now the decision-maker has some consistency in his decisions. 

#### [**Criticisms of Utility Theory**](https://en.wikipedia.org/wiki/Utility#Discussion_and_criticism):

Some main criticisms of the UT:

1) **Realism**: people don't really act *as-if* they maximize utility, which is not necessarily true: no one chooses objects after consulting some numerical index of goodness. So, what can we **falsify**?

2) **Inconsistent or probabilistic choice**: the individual may choose an object with lower utility for some random reason. But the standard model assumes choices are innate and unchanging. This is the notion of [**random utility**](https://www.sciencedirect.com/topics/social-sciences/random-utility-theory).

3) **Origin of preferences**: tastes change, or [**De Gustibus Non Est Disputandum**](https://www.jstor.org/stable/1807222?seq=1#page_scan_tab_contents).

4) **Procedural vs consequentialist aspects of choice**: If x is chosen from set A, individual is just as well off if given a choice from A vs simply given x without opportunity to choose. But maybe individuals value the freedom to choose, while at the same time too many options can be bad(choice overload).

Despite the criticism, the standard model still remains the workhorse model and remains useful, but important to remember it is **based on assumptions on human behavior** and not laws of nature.

#### Preference Relations 

Let's extend our knowledge about [**preference relations**](https://en.wikipedia.org/wiki/Debreu_theorems) $\succeq$:

i) **Monotonicity**: implies that if x $\in$ X and y ≥ x $\implies$ y $\succeq$ x. If y ≠ x and y ≥ x $\implies$ y $\succ$ x, then strictly monotone.

ii) **Locally non-satiation**: $\forall$x and all $\delta$ > 0, $\exists$y such that:

\[|| y - x  || < \delta \text{ and } y \succ x\]

iii) **Convexity**: if $\forall$x, y $\succeq$ x, z $\succeq$ x and y ≠ z $\implies$ that $\forall$ $\alpha \in$ (0,1):

\[ \alpha y + (1 - \alpha)z \succeq x  \]

This means that people would rather have moderation/diversification rather than concentrate their choices in one good. 

iv) **Continuity**: the preference relation has to be preserved under limits: for any sequence {$(x^n, y^n)$}$^\infty_{n=1}$ with $x^n \succeq y^n \forall$ n, $x \succeq y$, where x and y are limit points of the sequence (this means "no jumps")(for more: MWG p 47).

#### Intermission

Let's take a break and recap two main lessons from what we've seen so far:

1) The axiomatic method is a useful way to think about complex assumptions we make.

2) With finite choice sets, the assumption of a **utility representation** is **equivalent** requiring preferences to be **complete, reflexive and transitive**. Continuity yields utility representation when choice set is not finite. 

#### Revealed Preferences

Let's jump into [**revealed preferences**](https://en.wikipedia.org/wiki/Revealed_preference)! How does a consumer react when he is faced with repeatedly having to choose a consumption bundle x $\in$ $\mathbb{R}^{L+}$? Well, if he chooses x over y, it is said that **x is directly revealed preferred to y**. The notation for this is: xR$^D$y. 

**General Axiom of Revealed Preferences**: this axiom says if $x^i$ is indirectly preferred to $x^j$, than $x^j$ cannot be strictly directly revealed preferred to $x^i$. So we have:

\[ x^i Rx^j \implies p^j x^j ≤ p^j x^i, \forall i,j  \]

We can also deal differently, with other axioms of Revealed preferences:

- [**The Weak Axiom of Revealed Preference(WARP)**](https://en.wikipedia.org/wiki/Revealed_preference#The_Weak_Axiom_of_Revealed_Preference_(WARP)): is one of the criteria which needs to be satisfied in order to make sure that the consumer is consistent with his preferences. If a bundle of goods a is chosen over another bundle b when both are affordable, then the consumer reveals that they prefer a over b. WARP says that when preferences remain the same, there are no circumstances (budget set) where the consumer strictly prefers b over a. By choosing a over b when both bundles are affordable, the consumer reveals that their preferences are such that they will never choose b over a, while prices remain constant. Put simply: if x$^i$R$^D$x$^j$ and x$^i$ ≠ x$^j$, then it is not the case that x$^j$R$^D$x$^i$.

- [**The Strong Axiom of Revealed Preference(WARP)**](https://en.wikipedia.org/wiki/Revealed_preference#Completeness:_The_Strong_Axiom_of_Revealed_Preferences_(SARP)): The strong axiom of revealed preferences is equivalent to the weak axiom of revealed preferences, except that the consumer is not allowed to be indifferent between the two bundles that are compared. That is, if WARP concludes a ⪰ b, SARP  goes further and concludes that a ≻ b. Put simply: if x$^i$Rx$^j$ and x$^i$ ≠ x$^j$, then it is not the case that $x^jRx^i$. 

GARP is a generalization of these two tests. Now we arrive at the central result of consumer theory:

**Afriat's Proposition**: let {($p^1,x^1$),...,($p^n,x^n$)} be a finite set of consumption choices. **If a finite set of demand data violates GARP, then these data are inconsistent with choice according to locally nonsatiated, complete, and transitive preferences**. Conversely, if a finite set of demand data satisfies GARP, then these data are consistent with choice according to strictly increasing, continuous, convex, complete and transitive preferences. This is important because it provides succint and testable conditions that a finite dataset must satisfy to be consistent with utility maximization. (more of this on Kreps!)

GARP is discussed in fields where people are interested in whether some utility function can explain things. Examples: 1) Behavioral: can we explain altruism etc. with utility?; 2) Family/household: are interfamily dynamics causing inefficiency or do families act like they have some common goal?

Then the slides turn to some examples of choices:

1) [**Giving According to GARP: An Experimental Test of the Consistency of Preferences for Altruism**](https://www.jstor.org/stable/2692289?seq=1#page_scan_tab_contents)

2) [**Grandmothers and Granddaughters: Old-Age Pensions and Intrahousehold Allocation in South Africa**](https://www.jstor.org/stable/3990043?seq=1#page_scan_tab_contents)

3) [**Choices, Values, and Frames**](https://www.worldscientific.com/doi/abs/10.1142/9789814417358_0016)



### **2) Demand Theory**

#### Introduction

With worked some basic ideas and settings and now are ready to advance to the second [**lecture**](https://gabrielvoelcker.netlify.com/mit/14.121lecture1.pdf): **Demand Theory**. This lecture relates to MWG's 2B-E, 3D-E, 3G-H chapters and Kreps chapters 2-4. 

Demand theory is an economic principle relating to the relationship between consumer demand for goods and services and their prices in the market. Demand theory forms the basis for the demand curve, which relates consumer desire to the amount of goods available.

#### Demand Theory

Consumer's want to **maximize their utility** restricted to a **budget constraint**. Let's see how that works. 

The consumer has a set of **possible consumption vectors** in a world with L goods, denoted by  **X** $\in \mathbb{R}^{L+}$. Obviously, the consumer has to pay for stuff, so for the prices of goods L we have the price vector **p** $\in \mathbb{R}^{L++}$. Endowed with a wealth **w**, the consumer has his **budget set** represented by $B_{p,w}$. Given this setting, the consumer faces that unavoidable question: **how should I spend my money in order to maximize my utility?** Let's represent this problem by the following notation:

<center> $B_{p,w}$ = {x $\in$ $\mathbb{R}^{L+}$ | $\sum_{i=1}^n$$p_ix_i$ ≤ w}. </center>

This is known as the [**Utility Maximization Problem**](https://en.wikipedia.org/wiki/Utility_maximization_problem). Formally, it can be written as:

<center> $max_{x\in B_{p,w}} u(x)\text{ or }max_{x\in \mathbb{R^{L+}}}u(x) \text{ such that p }\times x ≤ w.$ </center>

Some comments about what we layed out so far:

1) Consumption decisions do not affect prices (price takers!).

2) Linear prices are typically justified by the possibility of resale.

3) There are no savings, after the last period is done all wealth should be spent.

#### [**Marshallian Demand Function(Walrasian Demand Correspondence)**](https://en.wikipedia.org/wiki/Marshallian_demand_function)

**Marshallian Demand Function(Walrasian Demand Correspondence**: assuming that the UMP is solved, this function specifies what which consumer would buy in each price and wealth circumstance. Denoted by: **x(p,w)**, it is equal to $\{z \in B_{p,w} | u(z) = max_{x \in B_{p,w}} u(x) \}$. Given that *u* is continuous and satisfies local nonsatiation. Then:

1) The UMP problem has at least one solution.

2) x(p,w) is [**homogenous**](https://en.wikipedia.org/wiki/Homogeneous_function) of degree 0, i.e. x($\alpha$p, $\alpha$w) = x(p,w) for all $\alpha$ > 0. This means that if both prices and wealth change in the same proportion ($\alpha$), then the individual's consumer choice doesn't change.

3) x(p,w) satisfies [**Walras’s law**](https://en.wikipedia.org/wiki/Walras%27s_law)([**2**](https://www.youtube.com/watch?v=5pCeeU5Jbbk)), i.e. p $\circ$ z = w for all z $\in$ x(p,w). An implication of Walras' Law is that the consumers budget will be balanced. Walras' Law states that the consumer fully expends his/her wealth over his/her lifetime.

4) If u is strictly quasi-concave, then x(p,w) is a function, i.e. each x(p,w) contains a single bundle.

Given that we want the solution to the UMP to be **optimal**, it is common to take the first derivative tests, also called Karush-Kuhn-Tucker or FOCs to find out what that optimal is. Allowing inequality constraints, the KKT approach to nonlinear programming generalizes the method of [**Lagrange multipliers**](https://en.wikipedia.org/wiki/Lagrange_multiplier), which allows only equality constraints. Similar to the Lagrange approach, the constrained maximization (minimization) problem is **rewritten as a Lagrange function whose optimal point is a saddle point**, i.e. a global maximum (minimum) over the domain of the choice variables and a global minimum (maximum) over the multipliers. 

Mathematically, we're trying to find a solution, $x^\ast \in x(p,w)$, to the UMP. Assuming that *u* is [**continuously differentiable**](https://en.wikipedia.org/wiki/Differentiable_function#Differentiability_and_continuity), then $\exists$ a constant $\lambda$ ≥ 0 such that:

\[ \frac{du}{dx_i} = \lambda p_i \, \forall i \in \{1,2,...,L\} \text{ with } x_i^\ast > 0 \]

and

\[ \frac{du}{dx_i} ≤ \lambda p_i \, \forall i \in \{1,2,...,L\} \text{ with } x_i^\ast = 0 \]

The $\lambda$ is known as the Lagrange multiplier.

[**Taylor's Theorem**](https://en.wikipedia.org/wiki/Taylor%27s_theorem): this a very useful math tool to have in your toolbox. It implies that:

Suppose $x^{\ast}$ is an [**interior solution**](https://www.thoughtco.com/what-is-an-interior-solution-4082800), and consider feasible perturbation x where agent spends $\Delta$ less on j and $\Delta$ more on i. [**Taylor's theorem**](https://en.wikipedia.org/wiki/Taylor%27s_theorem) implies: 

<center> u(x') $\approx$ u($x^{\ast}$) + $\frac{\partial u}{\partial x_j}$ u($x^{\ast}$) (-$\frac{\Delta}{p_j}$) + $\frac{\partial u}{\partial x_i}$ ($x^{\ast}$) ($\frac{\Delta}{p_i}$) </center>

Since $x^{\ast}$ maximizes utility, perturbation x' can't increase utility; hence, for small $\Delta$,

<center> $\frac{\partial u}{\partial x_j}$ $\frac{(x^{\ast})}{p_j}$ ≥ $\frac{\partial u}{\partial x_i}$ ($\frac{(x^{\ast})}{p_i}$)  </center>

Repeat for x'' where spend $\Delta$ more on j, and $\Delta$ less on i. Hence

<center> $\frac{\partial u}{\partial x_j}$$\frac{(x^{\ast})}{p_j}$ = $\frac{\partial u}{\partial x_i}$ $\frac{x^{\ast}}{p_i}$ </center>

#### Elasticities

Imagine that you have a certain demand, but then your income or the prices change. Naturally that would lead to a change in your demand. How can we deal with that? In terms of changes in income:

<center> $\eta_i$ = $\frac{\partial x_i}{\partial w}$ $\circ$ $\frac{w}{x_i}$ = $\frac{\partial log x_i}{\partial log w}$</center>

The effect of prices:

<center>$\varepsilon_{ij}$ = $\frac{\partial x_i}{\partial p_j}$ $\circ$ $\frac{p_j}{x_i}$ = $\frac{\partial log x_i}{\partial log p_j}$</center>

Have you noticed that the elasticities are unit-less? That's appealing! Elasticities must satisfy “adding up constraints” implied by [**Walras’ law**](https://en.wikipedia.org/wiki/Walras%27s_law).

**Proposition**: let $s_i$ be the budget share of the good i, $s_i$ = $\frac{p_ix_i(p,w)}{w}$. Then there are two aggregations that are useful to learn about:

1) [**Engel aggregation**](https://www.youtube.com/watch?v=BvXVhd9Y3N8): total expenditure must change by an amount equal to any wealth change. Formally: $\sum_{i=1}^n s_i \eta_i$ = 1. The Engel aggregation means that not all goods are luxuries ($\eta_i >1$), or necessities ($\eta_i <1$) or inferior goods ($\eta_i < 0$).

2) [**Cournot aggregation**](https://www.youtube.com/watch?v=-hkIadrfNGM): $\sum_{i=1}^n s_i \varepsilon_{ij}$ = -$s_j$. The Cournot aggregation says that the budget share $s_j$ of the good j is small when the good j has many substitutes ($\varepsilon_{ij}$ > 0), and big when it has many complements ($\varepsilon_{ij}$ < 0), or their respective budget shares are large.

#### [**Indirect Utility Functions**](https://en.wikipedia.org/wiki/Indirect_utility_function) and [**2**](https://www.youtube.com/watch?v=O3_It-2KEzU)

In economics, a consumer's **indirect utility function** *v(p,w)* gives the consumer's maximal attainable utility when faced with a vector p of goods prices and an amount of income w. It reflects both the **consumer's preferences** and **market conditions**.

This function is called indirect because consumers usually think about their preferences in terms of what they consume rather than prices. A consumer's indirect utility v(p, w) can be computed from his or her utility function u(x), defined over vectors x of quantities of consumable goods, by first computing the most preferred affordable bundle, represented by the vector x(p, w) by solving the utility maximization problem, and second, computing the utility u(x(p, w)) the consumer derives from that bundle. The resulting indirect utility function is

<center>**v(p,w) = u(x(p,w))**</center>

##### **Properties**

1) Continuous on $\mathbb{R}_+^n$ x $\mathbb{R}_+$ where *n* is the number of goods;

2) Decreasing in prices;

3) Strictly increasing in income

4) [**Homogenous**](https://en.wikipedia.org/wiki/Homogeneous_function) with degree zero in prices and income; if prices and income are all multiplied by a given constant the same bundle of consumption represents a maximum, so optimal utility does not change;

5) quasi-convex in (p,w).

So, formally the **indirect utility function** v(p,w): $\mathbb{R}^L$ x $\mathbb{R}$ $\rightrightarrows \mathbb{R}$ is defined by: 

v(p,w) = max$_{x \in B_{p,w}}$ u(x)

Alternatively, this is v(p,w) = u(x(p,w)) if x(p,w) is a function or v(p,w) = u($x^{\ast}$) for some $x^{\ast}$ $\in$ x(p,w).

#### [**Theorem of the Maximum**](https://en.wikipedia.org/wiki/Maximum_theorem)

The maximum theorem provides conditions for the continuity of an optimized function and the set of its maximizers with respect to its parameters.

So, formally: given A $\subset$ $\mathbb{R}^N$ and the closed set Y $\subset$ $\mathbb{R}^K$, the correspondence f: A $\rightrightarrows$ Y is **upper hemicontinuous** if it has a closed graph and images of compact sets are bounded.

- **Closed graph**: for any two sequences $x^m$ -> x and $y^m$ -> y with $x^m$ $\in$ A and $y^m$ $\in$ f($x^m$) $\forall$ m, then y $\in$ f(x).

- Images of compact sets are bounded: for every compact set B $\subset$ A, the set f(B) = {y $\in$ Y : y $\in$ f(x) for some x $\in$ B} is bounded.

##### [**Hemicontinuity**](https://en.wikipedia.org/wiki/Hemicontinuity)

In mathematics, the notion of the continuity of functions is not immediately extensible to **multivalued mappings** or correspondences between two sets A and B. The dual concepts of upper hemicontinuity and lower hemicontinuity facilitate such an extension. Roughly speaking, a function is upper hemicontinuous when a convergent sequence of points in the domain maps to a sequence of sets in the range which contain another convergent sequence, then the image of limiting point in the domain must contain the limit of the sequence in the range. **Lower hemicontinuity** essentially reverses this, saying if a sequence in the domain converges, given a point in the range of the limit, then you can find a sub-sequence whose image contains a convergent sequence to the given point. So, a correspondence Γ : A → B is said to be lower hemicontinuous at the point a if for any open set V intersecting Γ(a) there exists a neighbourhood U of a such that Γ(x) intersects V for all x in U. (Here V intersects S means nonempty intersection V $\cap$ S ≠ $\varnothing$.

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("1.png")
 grid.raster(img)
```

So, given A $\subset$ $\mathbb{R}^n$ and the compact set Y $\subset$ $\mathbb{R}^K$, the correspondence f: A $\rightrightarrows$ Y is **lower hemicontinuous** if $\forall x^m$ -> $x \in A$ with $x^m \in A$ for all *m*, and $y \in f(x)$, we can find a sequence $y^m$ -> y and an integer M such that $y^m \in f(x^m)$ for m > M.

Given the function **f**, we say that it is lower hemicontinuous correspondence $\iff$ it is continuous. If a correspondence is both upper and lower hemicontinuous, we say it is continuous.

<center> max *f*: $\mathbb{R}^N$ -> R subject to x $\in$ C(q) </center>

C(q) is a nonempty constraint set and q $\in$ Q belongs to an admissible set Q $\in$ $\mathbb{R}^S$. Suppose *f* is continuous and C(q) is compact for every q $\in$ Q. We already know that there exists a solution. When is the solution “continuous”, when is the objective function “continuous”? Let x(q) be the set of solutions and v(q) be the associated maximum value.

**Theorem**: suppose that f($\circ$) is a continuous function and the constraint correspondence C: Q $\rightrightarrows$ $\mathbb{R}^N$ is continuous. Then the maximizer correspondence x: Q $\rightrightarrows$ $\mathbb{R}^N$ is upper hemicontinuous and the value function v: Q -> $\mathbb{R}$ is continuous.

#### [**Expenditure Minimization Problem**](https://en.wikipedia.org/wiki/Expenditure_minimization_problem)

We know that the agent is trying to maximize his utility. But that would be too easy, and unrealistic, if he could spend as much as he wanted to, right? Then comes in the **Expenditure Minimization Problem**, the dual of the utility maximization problem: "how much money do I need to reach a certain level of happiness?". This question comes in two parts. Given a consumer's utility function, prices, and a utility target,

- how much money would the consumer need? This is answered by the expenditure function.

- what could the consumer buy to meet this utility target while minimizing expenditure? This is answered by the Hicksian demand function.

So, formally: the EMP is:

<center> $min_{x \in \mathbb{R}^{L^+}}$  p $\circ$ x s.t.u(x) ≥ $u_0$ </center>

or

$min_{x \in C_{u_0}}$ p $\circ$ x where $C_{u_0}$ = {z $\in$ $\mathbb{R}_L^+|u(z)$ ≥ $u_0$} 

which is the minimum level of wealth required to achieve utility $u_0$.

**Proposition**: Suppose u(x) is a continuous utility function satisfying local nonsatiation and p $\gg$ 0. Then the solution to the EMP is related to the solution to the UMP by a **basic duality result**:

1) If $x^{\ast}$ is a solution to the UMP with wealth w, then $x^{\ast}$ is a solution to the EMP with utility u($x^{\ast}$).

2) If $x^{\ast}$ is a solution to the EMP with utility $u_0$, then $x^{\ast}$ is a solution to the UMP with wealth p · $x^{\ast}$

The EMP is used mostly to define two functions:

1) [**Expenditure Function**](https://en.wikipedia.org/wiki/Expenditure_function): gives the minimum amount of money an individual needs to spend to achieve some level of utility, given a utility function and the prices of the available goods. So, formally: e: $\mathbb{R}^{L+}$ x $\mathbb{R}$ -> $\mathbb{R}$ is defined by

<center> e(p,u) = $min_{x \in \mathbb{R}^{L+},s.t. u(x)≥u}$ p $\circ$ x or $min_{x \in C_u}$ p $\circ$ x. </center>

2) [**Hicksian Demand Correspondence**](https://en.wikipedia.org/wiki/Hicksian_demand_function): a consumer's Hicksian demand correspondence is the demand of a consumer over a bundle of goods that minimizes their expenditure while delivering a fixed level of utility. If the correspondence is actually a function, it is referred to as the Hicksian demand function, or compensated demand function. So, formally: h: $\mathbb{R}^{L+}$ x $\mathbb{R}$ $\rightrightarrows$ $\mathbb{R}^{L+}$ is defined by

<center> h(p,u) $\equiv$ {z $\in$ $\mathbb{R}^{L+}$|p$\circ$z = e(p,u) and u(z) ≥ u} </center>

or

<center> h(p,u) $\equiv$ arg $min_{z \in C_u}$ p$\circ$z </center>

+

<center> h(p,u) $\equiv$ {z $\in \mathbb{R}^{L+}|z$ solves EMP at price utility u} </center>

The Hicksian demand is often called the **compensated demand function**. This is due to the fact that h(p,u) = x(p,e(p,u)), or the Hicksian demand can be used to answer: “how would demand change if we change prices from p to p' 0 **and** give whatever compensation is necessary so the utility level is unchanged.”

**Calculating Hicksian demands**: FOCs for calculating Hicksian demands are: 

<center> $p_i$ = $\lambda \frac{du}{dx_i}$(h(p,u)) if $h_i$(p,u) > 0 </center>

<center> $p_i$ ≥ $\lambda \frac{du}{dx_i}$ (h(p,u)) if $h_i$(p,u) = 0 </center>

Basic properties of the Hicksian demands: suppose u is a continuous utility function satisfying local nonsatiation. Then, the expenditure function e(p, u) is

1) homogenous of degree 1 in p, i.e. e($\alpha$p, u) = $\alpha$e(p, u)

2) trictly increasing in u and non-decreasing in each $p_i$

3) concave in p

4) continuous in p,u

**Properties of Hicksian Demands**: Suppose u is a continuous utility function satisfying local nonsatiation. Then the Hicksian demand correspondence h(p, u) satisfies:

1) h is [**homogenous**](https://en.wikipedia.org/wiki/Homogeneous_function) of degree 0 in p, i.e. h($\alpha$p,u) = h(p,u), $\forall \alpha,p,u

2) No excess utility property: u(x) = u $\forall$ x $\in$ h(p,u)

3) If u is strictly  quasi-concave, then each h(p, u) contains a
single element, i.e. h(p, u) is a function.

Notes: 

1) is a little different from Walrasian demand. That was homogenous of degree 0 in p and x. Here if we just multiple p and keep u constant, budget is implicitly multiplied.

2) is like Walras’s Law. If x gives extra utility you could have
bought less.

[**Compensated Law of Demand**](https://en.wikipedia.org/wiki/Hicksian_demand_function): One new result we get with Hicksian demand is the Compensated Law of Demand. Suppose *u* is a continuous s, strictly quasiconcave utility function
satisfying local nonsatiation, then for all p' and p'', we have

<center> (p'' - p')$\circ$[h(p'',$u_o$) - h(p',$u_0$)] ≤ 0 </center>

This says that in some weighted average, the demand goes down for products that have gone up in price.

**Corollary**: if $p_i$ increases and all other goods' prices are unchanged, then the Hicksian demand for good i decreases, i.e. $h_i$(p',$u_0$) ≤ $h_i$(p,$u_0$) if $p_i'$ > $p_i$ and $p_j'$ > $p_j$, $\forall j ≠ i$.

**Proposition**: suppose u is a continuous, strictly quasiconcave utility function satisfying local nonsatiation. Then for i = 1, 2, ..., L, we have:

<center> $h_i(p,u)$ = $\frac{d}{dp_i}$e(p,u) </center>

There are a few ways to prove this result. We will use the [**Envelope Theorem**](https://en.wikipedia.org/wiki/Envelope_theorem).

**Corollary**: suppose u is continuous, quasi-concave and satisfies local
nonsatiation and h is continuously differentiable. Then $\frac{\partial h_i}{\partial p_j}$ = $\frac{\partial h_j}{\partial p_i}$

[**Envelope Theorem**](https://en.wikipedia.org/wiki/Envelope_theorem): is a result about the differentiability properties of the objective function of a parameterized optimization problem. As we change parameters of the objective, the envelope theorem shows that, in a certain sense, changes in the optimizer of the objective do not contribute to the change in the objective function. The envelope theorem is an important tool for comparative statics of optimization models. So, formally, we start with the simple version:

Let $\phi$($\alpha$) = $max_{x \in \mathbb{R}^L}$ f(x;$\alpha$). Suppose $\phi$ is differentiable at $\overline{\rm \alpha}$ and f(x;$\alpha$) is uniquely maximized at x($\overline{\rm \alpha}$). Then

<center> $\frac{d \phi}{d \alpha_i}$ = $\frac{\partial f}{\partial \alpha_i}$(x($\overline{\rm \alpha}$);$\overline{\rm \alpha}$) </center>

**Proof**: follows directly from the chain rule:

<center>$\frac{d \phi}{d \alpha_i}$ = $\frac{\partial f(x(\overline{\rm \alpha});\overline{\rm \alpha})}{\partial \alpha_i}$ + $\sum_{j = 1}^L$ $\frac{\partial f}{\partial x_j}$ (x($\overline{\rm \alpha}$);$\overline{\rm \alpha}$)$\frac{\partial x_j}{\partial \alpha_i}(\overline{\rm \alpha})$ = $\frac{\partial f (x(\overline{\rm \alpha});\overline{\rm \alpha})}{\partial \alpha_i}$ </center>

as the second term drops out since x($\overline{\rm \alpha}$) maximizes f.

##### [**Slutsky Substitution**](https://en.wikipedia.org/wiki/Substitution_effect): 

If income is altered in response to the price change such that a new budget line is drawn passing through the old consumption bundle but with the slope determined by the new prices and the consumer's optimal choice is on this budget line, the resulting change in consumption is called the Slutsky substitution effect. The idea is that **the consumer is given enough money to purchase her old bundle at the new prices, and her choice changes are seen**.

So, Slutsky thought about compensation a little differently. Instead of just giving enough to achieve the same utility, imagine giving $\Delta$ p $\circ$ x so people can afford same bundle. This usually makes them strictly better off.

**Definition**: the **Slutsky substition matrix** S(p,w) is the L x L matrix with

<center> $s_{ij}$ = $\frac{\partial x_i}{\partial p_j}$ + $\frac{\partial x_i}{\partial w}$ $x_j$ </center>

This means the change in $x_i$ resulting from changing $p_j$ **and** giving consumer wealth $x_jdp_j$ to make old bundle affordable.

What happens to the consumption of good j as the price of good i rises?

1) change in relative price of the k goods (substitution), and

2) reduction of real income of consumer (income effect)

**Proposition**: Suppose *u* is continuous, locally nonsatiated, and strictly quasi-concave. Let w = e(p, $u_0$). Then

<center> $\frac{\partial h_i}{\partial p_j}$(p,$u_0$) = $\frac{\partial x_i}{\partial p_j}$(p,w) + $\frac{\partial x_i}{\partial w}$(p,w)$x_j$(p,w) = $s_{ij}$ </center>

Rewriting:

<center> $\frac{\partial x_i}{\partial p_j}$(p,w) = $\frac{\partial h_i}{\partial p_j}$(p,$u_0$) - $\frac{\partial x_i}{\partial w}$(p,w)$x_j$(p,w) </center>

The first element after the = is the relative price effect, the second is the real income effect.

**Corollary**: Under the conditions above, the Slutsky substitution matrix is **symmetric** and **negative semi-definite**.

**Symmetry**: can understand why same sign: if rise in price of good i causes demand for good j to rise, then j is in some sense substituting for i. If j substitutes for i, then i must substitute for j. No easy intuition for why they are equal: if 1 cent rise in price of good i means a fall in demand for good j of 10 units, then a 1 cent rise in price of good j means a fall in demand for good i of 10 units.

We saw how h(p, u) is the derivative with respect to p of the EMP’s value function e(p, u). Do not have exact same statement for UMP because Walrasian demand is an ordinal concept.

Do not have exact same statement for UMP because Walrasian demand is an ordinal concept.

[**Roy's Identity**](https://en.wikipedia.org/wiki/Roy%27s_identity): is a major result in microeconomics having applications in consumer choice and the theory of the firm. The lemma relates the ordinary (Marshallian) demand function to the derivatives of the indirect utility function. Specifically, denoting the indirect utility function as v(p,w),} the Marshallian demand function for good i can be calculated as 

<center> $x_i^m$ = $\frac{\frac{\partial v}{\partial p_i}}{\frac{\partial v}{\partial w}} </center>

where p is the price vector of goods and *w* is income. So, it provides analogous result when we normalize utility by marginal utility of wealth.

Suppose that u($\circ$) is continuous utility function and preferences are locally nonsatiated and strictly convex. Suppose that the indirect utility function is differentiable at ($p^{\ast},w^{\ast}$) $\gg$ 0. Then for every i = 1, ..., L,

<center>$x_i(p^{\ast},w^{\ast})$ = -$\frac{\partial v (p^{\ast},w^{\ast})}{\partial p_i}$ / $\frac{\partial v (p^{\ast},w^{\ast})}{\partial w}$ </center>

<center>
```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("2.png")
 grid.raster(img)
```
</center>

### **3) Putting Consumer Theory to Work**

#### Intro

In this third [**lecture**](https://gabrielvoelcker.netlify.com/mit/14121lecture3.pdf) we deal with putting what we learned about the consumer to work. The MWG's chapters for reference: 3I, 4A-B and 4D. The lecture deals with 7 main ideas:

#### 1) Price Changes and Welfare

Central question in applied micro: **How do price changes affect welfare?**

This happens in different ways: taxes, inflation, monopoly pricing, redistribution of wealth, innovation, among others. So let's imagine a change in price with no compensation: $u_0 = v(p^0,w) \rightarrow u_1 = v(p^1,w)$. Which is better: $u_0$ or $u_1$? So how can we know if the consumer is better off after the change in prices? There are two most commonly used **welfare measures**: 

1) **Equivalent Variation**(EV): how much money would compensate the change in utility? This is formally denoted by:

\[ EV(p_0, p_1, w) = e(p^0,u_1) - e(p^0, u_0) = e(p^0,u_1) - w\]

2) **Compensating Variation(CV)**: given that the prices have changed, how much the consumer would need to be paid to be as well off? This is formally denoted by:

\[ CV(p_0,p_1,w) = e(p^1, u_1) - e(p^1,u_0) = w - e(p^1,u_0) \]

How do we evaluate these objects? The standard way is to use the Hicksian-Expenditure theorem. In practice, we use the **Slutsky equation**(remember it from last lecture?) to go **from observed Marshallian demand to Hicksian demands**. 

#### 2) Welfare from new goods

What happens to welfare if a new good is introduced or an old one is discontinued? We can calculate that change by getting the CV from the invention of the new good:

\[ \int_{p_i}^\infty h_i(p_i,p_{-i},u_0)dp_i \]

A difficulty with estimating this empirically is that you rely on estimates with *p* outside the range of observed prices. So let's set $\hat{p}_i$ to be the virtual price at which the demand for good *i* would go to zero. Then, we change the above equation into:

\[ \int_{p'_i}^{\hat{p}_i} h_i(p_i,p_{-i},u_0)dp_i \]

There are 3 main scenarios to estimate welfare changes:

1) no income effects on demand: x(p,w) = x(p). Then 

\[ EV = CV = - \int_{p_i^0}^{p_i^1} x(p_i,p_{-i})dp_i \]

Is that reasonable? Depends. We may be dealing with inexpensive items or this may be the only way we can work.

2) Non-parametrically go from Marshallian to Hicksian: having already noted how we can use Slutsky to go from Marshallian to derivatives of Hicksian, we can solve the PDE to find the Hicksian demand. We can then specify demand as x(p,w) + $\eta$, where $\eta$ is scalar heterogeneity.

3) Convert from Marshallian to Hicksian via functional form assumption: we have to assume some econometric form, so why not assume:

\[ x_i(p,w) = \alpha_0 - \sum_j \beta_jp_j - \gamma w + \varepsilon \]

#### 3) Price indexes    
    
We can also measure welfare change using **price indexes**. The CPI is used to account for inflation. Setting: at t = 0, we see prices $p^0$ and consumption $x^0$. At t = 1, we see prices $p^1$ and consumption $x^1$. Two of the most common price indexes [**are**](https://en.wikipedia.org/wiki/Price_index#Paasche_and_Laspeyres_price_indices):

1) **Laspeyres**: holds consumption from the first period: $\frac{p^1 \times x^0}{p^0 \times x^0}$. 

2) **Paasche**: holds consumption from the second period: $\frac{p^1 \times x^1}{p^0 \times x^1}$. 

For their own reasons, it is understood that both price indexes above understate inflation. One could also estimate the expenditure function changes ($\frac{e(p^1,u^0)}{e(p^0,u^0)}$), but this impossible $\rightarrow$ how can one estimate price and income elasticity for all products in an economy? We could also use the [**Fisher Ideal**](https://corporatefinanceinstitute.com/resources/knowledge/economics/fisher-price-index/) which is the square root of Paasche times Laspeyres.

#### 4) Choosing functional forms    
    
We choose simpler functional forms than reality: how could we analyze the demand over **all** the goods we want to consume? So we choose simpler functions! How do we do that?
    
##### 1) **Restrict preferences**: makes the demand within a group of goods to be independent of prices outside of that group. 

So given group $g$, for each $i$ $\in$ g:

\[ x_i = x_i(p,w) = x_i(p_g,w_g)  \]

This budgeting process involves two steps: 1) allocating the group expenditures; then 2) make choices within groups.

##### 2) **Restrict price movements**: assumes that the prices within a group move proportionally. 
    
Suppose there are 3 goods, but we want to treat goods 2 and 3 as a group, so that we deal with $x_1$ and *X*(the composite good). Letting $\hat{p}_2$ and $\hat{p}_3$ be "base" prices, so that: $p_2 = q \hat{p}_2$ and $p_3 = q \hat{p}_3$, we can have that $\forall$ ($x_2,x_3$), let *X* = $\hat{p}_2x_2 + \hat{p}_3x_3$. So now, we're dealing with a new problem:

\[ max \, \tilde{u} (x_1,X) \text{ s.t. } p_1x_1 + qX ≤ w \]

Do we have the same solution if group the goods? Use Roy's Identity and see slides for more.
    
#### 5) Integrability    
    
Does the set of demand functions correspond to utility maximization? Why is that relevant?

This is relevelant because integrability allows us to make sure the *x* corresponds to a particular *u*. We play by the rules that agents are rational, which would imply that: 1) x is homogeneous of degree 0; 2) x satisfies Walras' law ($\sum p_i x_i(p,w) = w$); 3) Slutsky matrix symmetric and negative semi-definite.

For most U, the Marshallian demands that result are a mess.
    
#### 6) Estimating Demand
    
How do modern applied microeconomists estimate demand? There are two main approaches:

1) **Products as primitives**: Audi ≠ Toyota ≠ Honda; 

2) **Characteristics as primitives**: size ≠ horse power. This goes deep, please see the lecture notes below.

We can use the [**Stone-Geary Preferences**](https://en.wikipedia.org/wiki/Stone%E2%80%93Geary_utility_function), which is a **quasi-homothetic** preference. The amount spent is linear in prices and incomes. For more on this, see slides, MWG 3.5. and link above.

**Proposition**: if preferences are homothetic, then demand is homogenous of degree 1 in income: $x(p,\alpha w) = \alpha x(p,w)$. Moreover, the income elasticity of demand is 1, so $\forall$ j: $\frac{\partial log (x_j)}{\partial log(w)}$ = 1. Homogeneity of degree 1 is often also expressed as: x(p,w) = $w\tilde{x}(p)$, where $\alpha = \frac{1}{p}$. 

[**Gorman Polar Form**](https://en.wikipedia.org/wiki/Gorman_polar_form): this functional form of indirect utility allows us to treat a **society of utility-maximizers as** if it consisted of a **single representative individual**. Gorman showed that this holds $\iff$ the demand is quasi-homothetic of form x(p,w) = $\alpha$(p) + w$\beta$(p) $\implies$ v(p,w) = (w - a(p))/b(p). For more math on this, see slides.

[**Almost Ideal Demand System**](https://en.wikipedia.org/wiki/Almost_ideal_demand_system): another approach, this one model expenditures shares $s_i = p_ix_i / w$ as functions of logs of prices and wealth. The AIDS model gives an arbitrary first-order approximation to any demand system and has many desirable qualities of demand systems. For instance it satisfies the axioms of order, aggregates over consumers without invoking parallel linear Engel curves, is consistent with budget constraints, and is simple to estimate. For more on this model, see slides and link above.

**Demand Estimation: Characteristics Space**. The alternate way to economize on parameters in empirical work is via **characteristics** space: *goods are seen as bundles of characteristics* and the consumer derive utility from these characteristics and some idiosyncratic taste. Setting: **X** = universe of objects of choice. **S** = universe of attributes of individuals. **B** = feasible choice set (x $\in$ B $\subset$ X). The behavior rule, *h*, maps how these 3 attributes relate to choices: *h(B,S) = x*. Then we deal with [**Luce's Axioms**](https://en.wikipedia.org/wiki/Luce%27s_choice_axiom). The 3 axioms are: **1)** No zero probability choices: P(y|s,B) > 0 $\forall B$; **2)** Independence of Irrelevant Alternatives: if you choose between water before coke, and sprite before coke, if you are given the choice to choose between water and sprite, if you add coke to the bundle of options it shouldn't affect your choice; **3)** Separability: $\tilde{v}$(s,x,z) = v(s,x) - v(s,z).

**Random Utility Models**: 

**Quasi-linearity**: we often assume quasi-linear direct utility in terms of the **numeraire**: 
\[  U^i(n,d_{ij}) = \alpha n + \phi_i (Z_j)  + \varepsilon_{ij} \]

Where *n* is the numeraire good. 
    
#### 7) Demand Aggregation

All the theory we have developed so far, can it be applied to a society? Depends if the demand is derived from a **representative consumer**. In microeconomics, we want to estimate aggregate demand for goods and use Marshallian-Hicksian relations to talk about welfare. This relates to the 4th chapter of MWG, that studies Aggregate Demand. Let's consider three questions:

1) Does it make sense to estimate aggregate demand as a function of p and aggregate w, or do we need to deal with wealth distributions? (the econometrician's perspective)

2) Does aggregate demand (if defined) satisfy the same relations as individual demand? (“positive representative consumer”)(positive theorist' perspective)

3) Do welfare measures derived from aggregate demand have meaning? (“normative representative consumer”)(welfarist's perspective) 

So the question is: can we use X(p,w) to denote Aggregate Demand? Our setting is: K consumers with Marshallian Demand $x^k(p,w^k)$. The aggregate demand is $X(p,w^1,...,w^K)$ = $\sum_{k=1}^K x^k(p,w^k)$. There are two classcial cases:

i) Considering homothetic preferences: $x^k(p,w^k)$ = $w^k \beta (p)$

ii) In more general terms, if individual preferences are homothetic butnot identical and incomes are proportional, then there exists a single preference ordering that generates aggregate demand.

So we can only write demand as a function of aggregate wealth only if: $\frac{\partial x_i^k}{\partial w^k}(p,w^k)$ = $\frac{\partial x_i^j}{\partial w^j}(p,w^j)$, $\forall$ goods i, individuals (j,k). This requires that all wealth effects are the same accross individuals and acorss wealth levels. 

**Proposition**: demand is a function of aggregate wealth $\iff$ the preferences are represented by indirect utility functions of the form: 

\[  v^k(p,w^k) = a^k(p) + b(p)w^k  \]

Two important questions before we finish:

1) Does aggregate demand corresponds to some "representative" consumer? No! 

2) Can we treat problems that involve the maximization of welfare as the maximization of the utility of the agents of society? Not in general! 

### **4) Producer Theory and Monopoly**

#### Introduction

The fourth [**lecture**](https://gabrielvoelcker.netlify.com/mit/14121lecture4.pdf) switches focus to the producer(supply) side of the market. Its content can be found on MWG's 5B-C and 12B.

#### Profit Maximization Problem

Analogously to the consumer, a firm also has a maximization problem: the **profit maximization problem**. Formally denoted by:

\[ \pi(p) = max_{y \in Y}y \times p \]

**Production sets**: consist in the possibilities of production of the firm. They're represented by y = {($y_1,...,y_L$)$\in \mathbb{R}^L$}. When we talk about inputs, then y is negative, when we talk about outputs, its positive. 

**Cost minimization problem**: is the dual problem of the profit maximization problem. Obviously firms want to maximize profits, but if they don't have costs, it wouldn't make any sense to care about the PMP, right? This problem is formally denoted by:

\[ c(p,q) \equiv min_{z \in \mathbb{R}^{L+1}} p z, \text{ s.t. } f(z_1,...,z_{L-1}) = q \]

Some interesting concepts:

**Marginal Rate of Transformation(MRT)**: calculates how much more of a good L you can produce when you produce one less unit of product K. $MRT_{lk}(\overline{\rm y})$ = $\frac{\frac{\partial F (\overline{\rm y})}{\partial y_l}}{\frac{\partial F (\overline{\rm y})}{ \partial y_k}}$.

**Marginal Rate of Substitution** calculates how much more of a good K you need to maintain the level of output given that you are producing one less unit of good L. It is denoted by: $MRTS_{lk}(	\overline{\rm z})$ = $\frac{\frac{\partial f (	\overline{\rm z})}{\partial z_l}}{\frac{\partial f(\overline{\rm z})}{\partial z_k}}$.

**Law of Supply**: quantitites respond in the same direction as price changes.

#### Properties of Production Sets

i) Y is nonempty.

ii) Y is closed. The set includes its boundary.

iii) No free lunch: you can't produce an output without using an input.

iv) Possibility of inaction: complete shutdown is possible.

v) Free disposal: the absorption of any additional amounts of inputs without any reduction in output is always possible. 

vi) Irreversibility.

vii) Nonincreasing returns to scale: any feasible input-output vector can be scaled down.

viii) Nondecreasing returns to scale: any feasible input-output vector can be scaled up.

ix) Constant returns to scale: vii + viii.

x) Additivity(free entry): if y and y' are both possible, then one can set up two plants that do not interfere with each other and carry out production plans independently. 

xi) Convexity.

xii) Y is a convex cone.

#### [**Comparative Statics**](https://en.wikipedia.org/wiki/Economic_equilibrium)

Comparative statics is the comparison of two different economic outcomes, before and after a change in some underlying exogenous parameter. It compares two different equilibrium states. It is used to study supply and demand when analyzing a single market. We use a **FOC** approach to comparative statics:

\[ F : \underbrace{X}_\text{Control set} \times \underbrace{T}_\text{how maximizer changes as we change T} \rightarrow \mathbb{R}\] where X,T $\subset {R}$

This FOC approach applies implicit function theorem to FOCs. Assume:

- Smoothness: F is twice continuously differentiable.

- Convexity of X.

- Strict concavity: $F_{xx} < 0$ (to get unique maximizer: $X^\ast (t)=${x(t)}).

- Interiority: for each *t*, x(t) is in the interior of X. 

**Robust comparative statics**: what if one the characteristics above is not satisfied? It's not the end of the world. We can make corrections, but for ex: if differentiable function makes point more easily, then economists use it.

When understanding how the settings react to perturbations, we can study how in a two-dimensional market one good can affect the other. Some useful knowledge:

**Increasing Differences**: A function f(x,y) satisfies **increasing differences** if the marginal gain from increasing x is larger when y is larger. Let X,Y $\subset$ $\mathbb{R}^L$ be lattices. A function f: $X \times Y \rightarrow \mathbb{R}$ satisfies **increasing differences** in (x,y) if: f(x',y') - f(x,y') ≥ f(x',y) - f(x,y) for any x' ≥ x and y' ≥ y. **Proposition**: if *f* is twice continuously differentiable, then *f* has increasing differences if and only if $\frac{\partial^2 f}{\partial x \partial \theta}$ ≥ 0, $\forall$ x,$\theta$.

**Supermodularity**: similar to ID. Let X $\subset \mathbb{R}^k$ be a lattice. A function f: X $\rightarrow \mathbb{R}$ is **supermodular** if: f(x $\vee$ x') + f(x $\wedge$ x') ≥ f(x) + f(x') for every x,x' $\in$ X. This concept is used to understand how one agent's decisions affect the behavior of other agents. Linking this to the soon to be mentioned concept of **lattice**, we define that $f: X \rightarrow \mathbb{R}^n$ on a sublattice X is **supermodular** if, $\forall$ x,y $\in X$:

\[F(x \wedge y) + F(x \vee y) ≥ F(x) + F(y) \]

Suppose X is a sublattice of $\mathbb{R}^2$. If y ≥ x or x ≥ y, then {x,y} = {$x \wedge y, x \vee y$}, so condition has no *bite*(?). Suppose instead that $x_1 > y_1$ and $y_2 > x_2$. Supermodularity implies:

\[ F(y_1,x_2) + F(x_1,y_2) ≥ F(x_1,x_2) + F(y_1,y_2) \]

or

\[ F(x_1,y_2) - F(y_1,y_2) ≥ F(x_1,x_2) - F(y_1,x_2) \]

The change($\Delta$) from increasing first argument from $y_1$ to $x_1$ can only go up when the second argument goes up from $x_2$ to $y_2$. From all we've discussed thus far, we can say that **Increasing Differences imply Supermodularity**.

Roll up your sleeves and let's work this on [**Problem Set 4, Question 4**](https://gabrielvoelcker.netlify.com/mit/14121.ps4_2019.pdf)!( Don't despair, the answer is [**here**](https://gabrielvoelcker.netlify.com/mit/14.121 ps4sol_2018.pdf)).

[**Theorem Topkis' Monotonicity Theorem**](https://en.wikipedia.org/wiki/Topkis%27s_theorem): The theorem allows researchers to understand how the optimal value for a choice variable changes when a feature of the environment changes. The result states that if f is supermodular in (x,$\theta$), and D is a lattice, then $x^\ast (\theta)$ = arg $max_{x \in D}$ f(x,$\theta$) is nondecreasing in $\theta$. The result is especially helpful for establishing comparative static results when the objective function is **not differentiable**.

#### Applications in Producer Theory

So, how do we solve the Profit Maximization Problem? There are many paths:

**Example 1 Proposition**: the choice of capital $k^\ast$(r,w,q) is weakly decreasing in r. So we ask ourselves: does the level of capital decrease with an increase in the cost of capital *r*? $\max_{k \in K} - rk - wl, \text{ s.t. }F(k,l) ≥ q$.

**Example 2**: cross price effects in PMP. How does *k* change with *w*? Will firms always substitute away from labor and use more capital or can things go the other way for some reason? If *k* and *l* are **substitutes** in production, then F(k,l) has decreasing differences. k and l are **complements** in production in F(k,l) has increasing differences.

[**Cobb-Douglas**](https://en.wikipedia.org/wiki/Cobb%E2%80%93Douglas_production_function): this function is a functional form of the production function, used to represent the relationship between two or more inputs. Simple example: $Y = AL^\beta K^\alpha$ where: Y = total production; L = labor input; K = capital input, A = total factor productivity; $\alpha \text{ and } \beta$ are the **output elasticities** of capital and labor. What does output elasticity mean? If $\alpha$ = 0.45, a 1\% increase in capital usage would lead to a 0.45\% increase in output. In terms of [**constant returns to scale**](https://en.wikipedia.org/wiki/Returns_to_scale), if $\alpha$ + $\beta$ = 1, it means that the produtivity factor display constant returns to scale. If they are < 1 it means that returns to scale are decreasing, while if they are > 1, then their returns to scale are increasing.

The standard PMP: 

\[ max_{k,l} pF(k,l) - rk - wl \]

Usuallt solved in steps:

  i) solve for $\hat{l}$(k,w) given w at capital k(holding r constant).
    
  ii) Plug in, and solve for $k^\ast$(r,w) as function of (r,w).
    
  iii) Plug in $k^\ast$ into $k^\ast$(r,w) to get $l^\ast$(r,w).

**Robustness to Feasible Set**: suppose we want to characterize function $f: X \times T \rightarrow \mathbb{R}$ where the conclusion of Topkis' theorem holds for any feasible set $\overline{\rm X} \subset X$. We can get away with a weaker condition: a function f: $\mathbb{R}^2 \rightarrow \mathbb{R}$ is **single-crossing** in (x,$\theta$) if $\forall$ x' > x and $\theta' > \theta$ if:

  i) f(x', $\theta$) - f(x,$\theta$) ≥ 0 implies that f(x',$\theta$') - f(x,$\theta$') ≥ 0,
  
  ii) f(x',$\theta$) - f(x,$\theta$) > 0 implies that f(x',$\theta$') - f(x,$\theta$') > 0. 
  
Also, if *f* has ID, the it is single crossing, but the converse is not necessarily true. Unlike ID, this condition is not symmetric in variables (x,$\theta$). For more, see [**here**](https://en.wikipedia.org/wiki/Monotone_comparative_statics) and read slides about **Monotonic Selection Theorem**(L4, 23/44).

#### **Multivariate Comparative Statics**

So far we've dealt with changes in only one variable. But what if:

\[ max_{(x_1,x_2)\in X \subset \mathbb{R}^2} F(x_1,x_2,t) \]

Earlier univariate version ot Topkis' theorem:

  - If has ID in ($x_1,t$), then the optimal value of $x_1$ holding $x_2$ constant is non-decreasing in *t*. The same holds for $x_2$.
  
But now, both variables are chosen simultaneously, there is no holding the other constant/fixed. They interact and give feedback to each other! So what do we do? Intuitively, if F has ID in ($x_1,x_2$), the indirect effects work in the same direction as the direct effects. If $x_2$ optimally increases in response to an increase in *t* $\implies$ more incentive to raise $x_1$. When *F* has ID in all pairs of variables, all indirect effects reinforce the direct effects, and this motivates the condition of **supermodularity**. The definition is as follows: For x,y $\in \mathbb{R}^n$, define **meet** and **join** as follows:

\[ x \wedge y = (min\{x_1,y_1\},...,min\{x_n,y_n\}) \rightarrow \text{aka greatest lower bound}\] 

\[ x \vee y = (max\{x_1,y_1\},...,max\{x_n,y_n\}) \rightarrow \text{aka least upper bound}\]  

[**Lattice and Sublattice**](https://en.wikipedia.org/wiki/Lattice_(order)): since we are talking about supermodularity, it's unavoidable to talk about lattices and sublattices. A **lattice** consists of a partially ordered set in which every two elements have a unique supremum (also called a least upper bound or join) and a unique infimum (also called a greatest lower bound or meet). For example:the natural numbers, partially ordered by divisibility, for which the **unique supremum is the least common multiple** and the **unique infimum is the greatest common divisor**. 

The definiton used in the slides for **sublattice** is very intuitive: when X $\subset \mathbb{R}^2$, this property means that if you take two non-ordered corners of a rectangle whose edges are parallel to the axes in X, then the other two corners are also in X. More generally, a sublattice is a subset of a lattice(shocking!). Example: any product set X = $X_1 \times \dots \times X_n$.

Given that we've arrived not following 100\% chronologically the lecture slides order, I now intend to turn to slide 28/44 and move forward knowing that we've stated that **ID $\implies$ supermodularity**. Now that we're dealing with multivariate analysis, we can state a broader notion of Topkis' theorem, the multivariate one:

If *X* is a sublattice, T $\subset \mathbb{R}$ and F: X $\times$ T $\rightarrow$ $\mathbb{R}$ is supermodular, then $\forall$ t,t' $\in$ T such that t' > t, and all x $\in$ $X^\ast$(t), x' $\in$ $X^\ast$(t'):

\[ x \wedge x' \in X^\ast (t) \text{ and } x \vee x' \in X^\ast(t')\]

Ok, but try to translate this equation into words/economics concept. Let me try: the first part of the equation states that the conjunction of all x and x' are contained in t. Their disjunction is in t', remembering that t' > t.(?)

**Le Chatelier Principle**: so economics started as a philosophical study(thanks, Adam Smith!) and in the beginning of the XX Century started to lay its foundations as a science. In order to help legitimize economics as a science, this [**guy**](https://en.wikipedia.org/wiki/Paul_Samuelson) decided to use a [**concept of Chemistry**](https://en.wikipedia.org/wiki/Le_Chatelier%27s_principle) in economics. It basically suggests that *a firm's reaction to input price changes is bigger on the longer term than in the short term*. 

This concept is interesting because we model long-term responses as larger than short term responses. Let's think about this in steps when factors are **substitutes**: 1)Start with f(k,l) where inputs are substitutes ($f_{kl}≤0$); 2) If capital(k) is fixed and wage(l) increases, what is natural thing you do if you ran the business? You would use less labor in your production; 3) Since the factors are substitutes, thatn increased wage implies an **increased** use of capital in the long-run; 4) Since $f_{kl}$ ≤ 0, additional capital used in long-run reduces marginal product of labor, so in the long run the firm will eventually use less labor. To sum up: **in the SR the firm only responds to the more expensive labor, in the LR it also responds to the increased capital stock that reduces marginal product of labor**. 

What if the two factors are **complements**, not substitutes? 1) $f_{kl}$ ≥ 0; 2) As $\uparrow$ w, firms use $\downarrow$ l in the SR and LR; 3) The $\Delta$ here is: **since inputs are complements, increased wage will lead to a reduced use of capital in LR**; 4) given $f_{kl}≥0$, reduced capital in long run will reduce marginal product of labor, so in the LR firm uses less labor.

**Proposition using Le Chatelier Principle**: suppose production is f(k,l) and that there will be a wage increase(w > $w_0$):

  a) if k and l are **complements**: $l_{LR}(w) ≤ l_{SR}(w_0,w) ≤ l_{LR}(w_0)$;
  
  b) if k and l are **substitutes**: $l_{LR}(w) ≤ l_{SR}(w_0,w) ≤ l_{LR}(w_0)$.
  
Honestly, what the difference between the two math parts above?

#### **Monopoly Pricing**: 

**What if q impacts p?** Let's assume a monopolistic setting to start thinking how quantities and price relate to each other. Setting: $\pi(q)$ is differentiable, concave and has an interior solution.

\[ max_{q}q \times P(q) - c(q) \]

The FOC for profit maximization: marginal revenue = marginal cost:

\[ q^m \times P'(q^m) + P(q^m) = c'(q^m) \]

**Proposition**: the percentage markup in the monopoly model is given by the [**Lerner Index**](https://en.wikipedia.org/wiki/Lerner_index):

\[ \frac{P(q^m) - c'(q^m)}{P(q^m)} = - \frac{1}{\varepsilon}  \]

$\varepsilon$: is the price elasticity of demand ($\frac{dQ}{dP} \frac{P}{Q}$). This basically describes the firm's market power. If a firm could raise its price indefinitely without losing demand, it would! But realistically speaking, people would stop consuming. Now, imagine that consumer price increase from $p^c$ to $p^m$. The loss to the consumer would be:

\[ CV = - \int_{p^c}^{p^m} x_i^h (p,u_0)dp \]

This depends on the **Hicksian demand**, not the Marshallian. So let's make a proposition about the quantity to be sold: Given any demand curve P(q) and cost function c($q,\theta$), define:

\[ q^m = sup \, arg max_{x} qp(q) - c(q,\theta) \]

If c($q,\theta$) has ID, then $q^m$ is weakly decreasing in $\theta$.

Another thing we worry about monopoly is quality, not only price. Suppose *s* denotes quality:

\[ W(q,s) = \int_0^q P(x,s)dx - c(q,s) \]

\[ \pi(q,s) = qP(q,s) - c(q,s) \]

If P(q,s) has decreasing differences, then the value of quality is less on the marginal unit sold then on the average unit. And the monopolist **only cares about the price of the marginal unit**. This gives rise about why the monopoly quality is too low. 

### **5) Externalities**

#### Introduction

This fifth [**lecture**](https://gabrielvoelcker.netlify.com/mit/14121lecture5.pdf) deals with externalities. The readings are MWG's 10th and 11th chapters. 

So far we've dealt with the two sides of the market: Supply(Producer) and Demand(Consumer). Now let’s look to the outsiders: Externalities.

**Externality**: is something that affects directly the well-being of the consumer(demand) and/or producer(supply). They can be either good or bad and may give rise to market failures. The objective of the lecture is divided in 4 steps: 1) Outline a simple model with an externality to illustrate why they cause market failure; 2) Discuss the Coase Theorem; 3) Discuss the difference between price and quantity regulations to deal with externalities; 4) Discuss a particular class of externality problems arising from common property resources.

#### Simple Model

Setting: two agents (i=1,2) price-takers. Wealth = $w_i$. L goods ($x_{1i},...,x_{Li}$). Then! Consumer 1 takes some action **h** $\in \mathbb{R}_+$ that directly affects Consumer 2! (ex: plays loud music late at night). Given that **h** represents the externality, let's assume quasi-linear utility with indirect utilities:

\[ v_i(p,w_i,h) = \phi_i(h) + w_i \]

Where we suppress dependence on *p*. We assume that $\phi$ is twice differentiable and $\phi_i''(.)$ ≤ 0. An allocation is represented by: ((x_i)$_{i=1,2},h$). At a competitive(Walrasian) equilibrium with prices *p*, each of the two consumers maximizes her utility given prices and wealth. But in order to maximize his utility, Consumer 1 chooses h ≥ 0, creating the externality. The equilibrium then:

\[ \phi_1' (h^\ast) ≤ 0 \]

[**Pareto Optimal**](https://en.wikipedia.org/wiki/Pareto_efficiency) states that an allocation that optimality is achieved when you can't improve a consumer's utility without decreasing some other consumer's utility. Let's denote *T* as a re-allocation of wealth from consumer 1 to 2. If $h^{PO}$ is the Pareto optimal level of h, then it must be that when T = 0 and h = $h^{PO}$ we have a solution of the following:

\[ max_{h,T}\phi_1 (h) + w_1 - T \text{ s.t. } \phi_2(h) + w_2 + T ≥ \overline{\rm u}_2 \]

The constraint must hold with equality (if not, we could lower T to improve the value of the program), so substituting for T:
 
\[ max_h \phi_1(h) + w_1 + \phi_2(h) + w_2 - \overline{\rm u}_2 = max_h \phi_1(h) + \phi_2(h)\]

The Pareto Optimal aims to maximize the joint surplus of the two consumers, which **doesn't mean the externality is eliminated**. Rather, the externality’s level is adjusted to the point that the marginal benefit of an extra unit of the externality $(\phi_1'(h^{PO}))$ to consumer 1 is equal to the marginal cost to the consumer 2, $-\phi_2'(h^{PO})$. If we assume an interior solution, the last two terms are equal to each other and $\phi_1'(h^\ast)$ = 0. If there are no external factors, then $\phi_2'(h^{PO})$ = 0 for all *h* $\implies$ $\phi_1'(h^\ast)$ = 0. So $h^{PO} = h^\ast$ and the Pareto Optimal level of *h* is the same as the competitive equilibrium. But if $\phi_2'(h^{PO})$ ≠ 0, then there are externalities! They can be:

1) Negative externality: $\phi_2'()$ < 0 $\implies$ $\phi_1'(h^{PO})$ = $-\phi_2'(h^{PO})$ > 0.

2) Positive externality: $\phi_2'()$ > 0 $\implies$ $\phi_1'(h^{PO})$ = $-\phi_2'(h^{PO})$ < 0 $\implies$ $h^\ast$ < $h^{PO}$.

#### Government Intervention

Given that there is a market failure, how can this situation be improved/corrected? Through Government Intervention? If so, there are two ways they can act:

**1) Quota**: government mandates that *h* be no larger than $h^{PO}$ $\implies$ consumer is obligated to fix his level of externality at $h^{PO}$.

**2) Taxes**: government can tax Consumer 1 on his consumption of 1 or subsidize the reduction of h. Imagine a tax per unit of $t_x$, so Consumer 1's maximization problem is now:

\[ max_{h}\phi_1 (h) - t_h h \]

If $t_h$ = - $\phi_2'(h^{PO})$ > 0, then the competitive equilibrium of *h* is now: $\phi_1'(h) = t_h$, or $\phi_1'(h) = - \phi_2'(h^{PO})$, and we know that h $h^{PO}$ satisfiest his condition. This type of intervention is called [**Pigouvian Tax**](https://en.wikipedia.org/wiki/Pigovian_tax).

This tax makes Consumer 1 internalize the externality the was being imposed on Consumer 2. 

**Subsidy**: but what if instead of a tax the government decided to pay a subsidy($s_h$) for each externality produced by Consumer 1? The problem now turns to be:

\[ max_h  \phi_1(h) + s_h (h^\ast - h) \]

Subsidy can be thought of as a tax per unit of $s_h$ per unit plus a lump-sum transfer of $s_hh^\ast$.

**Direct vs indirect taxation**: if a plant produces pollution(which is bad, btw), what is more interesting: taxing the output of the plant or the pollution itself? Taxing the former wouldn't help restore optimality. But when there is a **monotonic** relation between the two of them, then taxing output is equivalent to taxing emissions. 

If government pays a subsidy of $s_h$ = -$\phi_2'(h^{PO})$ > 0 for each unit that consumer 1's choice of h is below $h^\ast$, then the maximization problem is: 

#### [**Coase Theorem**](https://en.wikipedia.org/wiki/Ronald_Coase)

Coase pointed how an externality arose from two factors: **1)** lack of clearly specified property rights; **2)** transaction costs. This was stated in the following theorem: *if property rights are clearly specified and there are no transaction costs, bargaining will lead to an efficient outcome no matter how the rights are allocated*. 

Let's look the bargaining approach from two sides: 1) C1 has to pay C2 for the right to cause h; and 2) C2 pays C1 to generate less h than what C1 would like to.

1) imagine an environment in which C1 can only cause an externality with permission from C2. C2 then makes a one-time offer to C1 demanding payment T in exchange for permission to cause h. C1 agrees iff: $\phi_1(h) - T ≥\phi(0) \rightarrow$ obviously the amount paid has to be inferior than what he stands to gain from being able to cause the externality. So how does C2 choose T? It has to max her utility, given the gains from T and the losses from the externality: $max_{h,T} \phi_2(h) + T \text{ s.t.} \phi_1(h) - T ≥ \phi_1(0)$. The constraint must be binding(after all why would C1 not maximize as much as possible h?): T = $\phi_1(h) - \phi_1(0)$. Plugging this into the maximizing function, we find the socially optima level: $max_{h}\phi_2(h) + \phi_1(h) - \phi(0)$. In this case, C1 pays $\phi_1(h^{PO}) - \phi_1(0) > 0$ to be allowed to set $h^{PO}$.

2) If C1 can generate h as much as he wants($h^\ast$), C2 would pay C1 to generate h < $h^\ast$. For C1 to agree to that, $\phi_1(h) - T$ has to be bigger than $\phi_1'(h^\ast)$. Now the problem is: $max_{h,T}\phi_2(h)+T = max_{h}\phi_2(h) + \phi_1(h) - \phi_1(h^\ast)$. In this case C1 gains $\phi_1(h^{PO}) - \phi_1(h^\ast) < 0$ in return for setting $h^{PO}$. 

The conclusion is that the negotiated level of *h* should be efficient:

**Coase Theorem**: *If property rights are clearly specified and there are no transaction costs, bargaining will lead to an efficient outcome no matter how the rights are allocated*. Some thoughts on that: **i)** we assumed a particular bargaining solution - take-it-or-leave it. Many other complete information bargaining solutions would generate the same prediction in this problem; **ii)** In special case where two parties are firms, another solution to let the two firms merge. The resulting firm would fully internalize the externality when maximizing profits. iii) Sometimes we refer to Coase as a decentralization result given that Coasians point to the absence of legal institutions as a central impediment to optimality; iv) Transaction costs Coase had in mind: 1) If large number of citizens impacted by externality, then there will be significant transaction costs to bring everybody to the table and start negotiating; 2) If participants have to pay an ex ante cost in order for an agreement to be reached (such as showing up to a meeting) then this can lead to inefficiencies arising for strategic reasons; v) Unlike the tax and quota schemes, Coase’s approach only requires that the consumers know each others preferences, and not government.

**Information Asymmetries**: but since we're talking about consumers know about each other, let's point out another difficulty: IA. I'll skip the algebra here(refer to slides 22-24 of Lecture 5), but given IA, then there will be positive probability of inefficiency, even though the efficient externality the efficient externality level is optimal when the externality is present. This happens because of the realistic setting that consumers may have information asymmetries. 

However, we have the [**Anti-Coase Theorem**](https://en.wikipedia.org/wiki/Myerson%E2%80%93Satterthwaite_theorem), proposed by [**Myerson**](https://en.wikipedia.org/wiki/Roger_Myerson)-[**Satterthwaite**](https://en.wikipedia.org/wiki/Mark_Satterthwaite): *no bargaining procedure can lead to an efficient outcome for all values of b and s when they are private information and independently distributed*. Anyway, there's a lot of discussion in whether we should regulate externalities or not, but that depends on a lot of factors. Are there market for externalities? Can we directly measure them? Should we regulate on price or quantity? Can market economies can generate efficient outcomes, if we think private information pervasive?

Let's go a little bit further: if we can define property rights on an externality, why isn't there a **market for the externality**? Suppose that there is a competitive market for the externality, and let $p_h$ be the price of the right to engage in one unit of the activity. In choosing how many of these rights to purchase, $h_1$, C1 solves $max_{h_1}\phi_1 (h_1) - p_h h_1$; C2 decides to sell rights, $h_2$: $\max_{h_2}\phi_1 (h_2) + p_h h_2$. Two FOCs are: $\phi_1'(h_1) = p_h$ and $\phi_2'(h_2) = - p_h$. Since $h_1$ must equal $h_2$, we have that the PO is: $\phi_1'(h^{**})$ = - $\phi_2'(h^{**})$

But externalities are inherently tied to absence of certain competitive markets(?).

#### Price vs Quantity Regulations

Coming back to what we talked about government intervention: how does intervention should take form? There is a [**difference**](https://www.jstor.org/stable/2296698?seq=1#page_scan_tab_contents) between price and quantity regulation: “*I think it is a fair generalization to say that the average economist in the Western marginal tradition has at least a vague preference towards indirect control by prices, just as the typical noneconomist leans toward the direct regulation of quantities.*” Weitzman's analysis is about pollution reduction. The government can achieve $q^\ast$ either by:

  i) quantity regulation: order firms or industry to do $q^\ast$ units of reduction.

  ii) pay firms a price $p^\ast$ for each unit of reduction undertaken (this price could be avoiding a tax)- firms would then choose q to maximize profits): q = arg max{p$^\ast$q - C(q)}. So the government just needs to set the price equal to $p^\ast$ = B'(q$^*$). 

This 1974 paper goes deep into the maths of this decision, incorporating Uncertainty, first-best and second-best solutions, optimal quantity and optimal price concepts, and arrive at a formula for the benefit of price regulation over quantity regulation. For more on this, read the already linked paper and slides 29-37 of Lecture 5.

#### Common Property Externalities

This type of externality arises whenever there is a commonly owned resource(fish in the ocean, forests). Also known as the [**Problem of the Commons**](https://www.investopedia.com/terms/t/tragedy-of-the-commons.asp). Imagine a lot of fishermen fishing on their own boats. The more people go out to fish, the less the average catch per boat will be. So what is the Optimal Number of Boats? It's the number of boats that maximize consumer surplus + fisherman surplus: $max_b \int_0^{y(s,b)} p(x)dx - wb$. Let's take FOC: p(y(s,$b^O$))$\frac{\partial y}{\partial b}(s,b^O) = w$. Social marginal benefit of boats is equalized with the social marginal cost The equilibrium has price of fish $p^\ast$ and number of boats $b^\ast$ such that Demand = Supply and fisherman make 0 profits: i) x($p^\ast$) = y($s,b^\ast$) $\iff$ $p^\ast$ = p($y(s,b^\ast)$); ii) $p^\ast (\frac{y(s,b^\ast)}{b^\ast}) = w$.

In a **free access equilibrium**, each fisherman's catch per boat times the price must equal the price of operating the boat. If we do the math, we'll arrive that average product > marginal product, which will lead to having too many boats.

For more on this, let's do exercise [**3 of Problem Set 5(originally from MWG 11.D.5**](https://gabrielvoelcker.netlify.com/mit/14121.ps5_2019.pdf)!( Don't despair, the answer is [**here**](https://gabrielvoelcker.netlify.com/mit/14.121 ps5sol_2018.pdf)).



### **6) Introduction to General Equilibrium**

#### Introduction

In this sixth [**lecture**](https://gabrielvoelcker.netlify.com/mit/14121lecture6.pdf) we deal with General Equilibrium. For more, read MWG's chapters 15 and 16. 

So far we've dealt with consumers, producers and externalities. How do they interact with each other? Can they get to a state of equilibrium? That's what General Equilibrium is all about. General Equilibrium deals with 6 main issues:

1) Welfare Theorems.

2) Existence of GE.
  
3) Properties of Equilibrium
  
4) Justifying Price-Taking assumption and Walrasian mechanism.
  
5) Indivisibilities.
  
6) Uncertainty.
  
I won't divide the lecture in these exact 6 categories in order to try to keep a narrative that flows better

#### Welfare

Setting: **Agents**: finite number(i $\in \mathcal{I}$ = {1,...,I}); **Commodities**: finite number l $\in$ $\mathbb{L}$ = {1,...,L}, and commodities are allocated such that x $\in \mathbb{R}_+^L$; **Endowment**: $\omega^i \in \mathbb{R}_+^L$; **Utility**: $u^i$ : $\mathbb{R}_+ \rightarrow \mathbb{R}$. So the GE depends on utility and wealth of each agent:$\mathcal{E}$ = ($(u^i,\omega^i)_{i \in \mathcal{I}}$). In order to choose consumption each agent has a budget constraint:

\[ max_{ \in \mathbb{R}_+^L} u^i(x) \text{ s.t. } p x ≤ p \omega^i   \]

It's **not** the same as the UMP! Now the consumer's wealth is $p \omega^i \rightarrow$ the amount she could obtain if she sold her entire endowment. In a **Walrasian Equilibrium** for economy $\mathcal{E}$ is a pair ($p,(x^i)_{i \in \mathcal{I}}$) such that 3 things hold:

1) Agents are maximizing utilities $\forall i \in \mathcal{I}$: $x^i \in arg \, max_{x \in B^i(p)} u^i(x)$.

2) Markets clear $\forall$ l $\in \mathcal{L}$,

\[ \sum_{i \in \mathcal{I} }x_l^i = \sum_{i \in \mathcal{I}}\omega_l^i \]

3) An allocation $(x^i)_{i \in \mathcal{I}} \in \mathbb{R}_+^{I \times L}$ is **feasible** if $\forall$ l $\in \mathcal{L}$: 

\[ \sum_{i \in \mathcal{I} }x_l^i ≤ \sum_{i \in \mathcal{I}}\omega_l^i \]

**Properties**: given economy $\mathcal{E}$, a feasible allocation x is **Pareto Optimal** if there is no other feasible allocation $\hat{x}$ such that either: i) $u^i(\hat{x}^i)$ ≥ $u^i$($x^i$) $\forall$ $i \in \mathcal{I}$(the total utility can be increased/equal for all agents); or $u^i(\hat{x}^i)$ > $u^i$($x^i$) for some $i \in \mathcal{I}$ (you can strictly increase utility of someone without hurting someone else). Is this fair? Pareto efficiency says nothing about distributional justice or equity! Let's now make some assumptions on preferences: 

**A1)** $\forall$ agents i $\in \mathcal{I}$, $u_i$ is continuous.

**A2)** $\forall$ agents i $\in \mathcal{I}$, $u_i$ is increasing, i.e.$u^i$(x′) > $u^i$(x) whenever x′ $\gg$ x.

**A3)** $\forall$ agents i $\in \mathcal{I}$, $u_i$ is concave.

**A4)** $\forall$ agents i $\in \mathcal{I}$, $\omega^i \gg 0$.

We’ll call these the *four assumptions*. 

#### 2 x 2 Economy

Let's expand to a new analysis. Setting: **Consumers**: i = 1,2. **Commodities**: l = 1,2. **Consumption vector** $x^i = (x_1^i,x_2^i)$. **Endowment**: $\omega^i$ = ($\omega_1^i, \omega_2^i$) $\in \mathbb{R}_+^2$; $\omega_l^i$ is the *i* endowment of commodity *l*. The **aggregate endowment**: $\omega = \omega^1 + \omega^2$; **aggregate endowment of good l**: $\omega_l = \omega_l^1 + \omega_l^2$. **Exchange economy**: is an economy in which no production is possible and the commodities that are ultimately consumed are those that individuals possess as *endowments*. In math terms: $\mathcal{E}$ = ($u_i,\omega^i$)$_{i=1,2}$. The subscripts represent the gcommodity the superscripts $\rightarrow$ the cconsumer

#### Edgeworth Box

Given we have two consumers and two goods, we have 4 dimensions to work with! An allocation x $\in \mathbb{R}^4$ assigns a non-negative consumption vector to each consumer:

\[ x = (x^1,x^2) = ((x_1^1,x_2^1),(x_1^2,x_2^2)) \]

Having established how consumption occurs, we now turn to the next question: **when is the consumption feasible**? When:

\[ x_l^1 + x_l^2 ≤ \omega_l^1 + \omega_l^2, \forall l    \]

Allocation is **non-wasteful** if the relation holds as an equality: $x^1 + x^2 = \omega$. Given the price vector p = $(p_1,p_2)$: $p \times \omega^i = p_1\omega_1^i + p_2\omega_2^i$. When the allocation is non-wasteful, they can be depicted by means of an [**Edgeworth Box**](https://en.wikipedia.org/wiki/Edgeworth_box). 

In an Edgeworth Box, C1's quantities are measured the usual way (SW corner = origin), while C2's quantities are measured using the northeast corner. For both consumers, the **vertical dimensions** measure quantities of **good 2**. Obviously, **the horizontal dimensions** measure the quantities of **good 1**. The size of the Edgeworth Box relates to the endowment of the economy: the length is the total endowment for good 1: $\hat{\omega}_1$. The same for height and endowment of good 2. As it is common when we study GE the wealth of a consumer is not given exogenously. Instead, for p = ($p_1,p_2$), consumer's *i*'s wealth equals the market value of his endowments of commodities: $p \omega_i  = p_1\omega_{1i} + p_2\omega_{2i}$. Hence, **wealth is determined by the values of prices**. So, for consumer's *i* endowment vector $\omega_i$ the budget set is:

\[ B_i(p) = \{ x_i \in \mathbb{R}^2_+ : p x_i ≤ p \omega_i \} \]

To use the Edgeworth Box to represent the budget sets of two consumers: we draw the budget line through the endowment point $\omega$ with slope -($\frac{p_1}{p_2}$) as shown in figure below:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("26.png")
 grid.raster(img)
```

C1's budget set all nonnegative vectors below the line. C2's budget set are above the line. Only allocations on the budget line are affordable to both consumers simultaneously at prices $(p_1,p_2)$.

**Offer Curve**: when the prices vary, the budget constraint changes. At each point on offer curve, the BC is tangent to indifference curve.

**Excess Demand**: total agent demand for a commodity minus what is available in the economy. 

**Pareto set**: allocations where indifference curves are tangent. If utilities are differentiable, Pareto allocations are characterized by: $\frac{\frac{\partial u^1}{\partial x_1}}{\frac{\partial u^1}{\partial x_2}}(x^1)$ = $\frac{\frac{\partial u^2}{\partial x_1}}{\frac{\partial u^2}{\partial x_2}}(\omega - x^1)$.

**Contract curve**: part of Pareto set where consumers do at least as well as initial endowment.

[**First Welfare Theorem**](https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics#Implications_of_the_first_theorem): when markets are complete, any competitive equilibrium is necessarily Pareto optimal(in other words: once we find an efficient allocation, we could support it with a price equilibrium $\rightarrow$ any Walrasian Equilibrium is Pareto Optimal). Formally: let (p,($x^i$)$_{i\in \mathcal{I}}$) be a Walrasian equilibrium for economy $\mathcal{E}$. If utility is increasing, then allocation $(x^i)_{i \in \mathcal{I}}$ is Pareto optimal. Some consequences of this theorem: **i)** even without explicit coordination, decentralized markets where agents simply maximize their utilities given prices are efficient; **ii)** Provides formal support for Adam Smith’s claim that individuals acting in their own interest result in efficient allocation from a societal standpoint; **iii)** only needed utility is increasing (could get away with LNS); **iv)** Should be emphasized that the model has a number of heroic assumptions; e.g., agents face the same prices, agents are price takers, markets exist for all goods, and we haven’t said where prices come from (maybe a little unrealistic). 

[**Second Welfare Theorem**](https://en.wikipedia.org/wiki/Fundamental_theorems_of_welfare_economics#Proof_of_the_second_fundamental_theorem): any Pareto optimal can be achieved as a competitive equilibrium if appropriate lump-sum transfers of wealth are arranged. Formally: let economy $\mathcal{E}$ satisfy our four assumptions. If $(\omega^i)_{i \in \mathcal{I}}$ is Pareto Optimal, then there exists a price vector p $\in$ $\mathbb{R}^L_+$ such that (p,($\omega^i$)$_{i \in \mathcal{I}}$) is a Walrasian equilibrium for $\mathcal{E}$. Again, some consequences: **i)** Does not say that starting from a given endowment, every
Pareto optimal allocation is a Walrasian equilibrium; **ii)** Rather, says if we start from a given endowment, then for any Pareto optimal allocation, there is a way to redistribute resources and prices that makes the allocation a Walrasian equilibrium outcome; **iii)** Unlike the FWT, convexity plays a role here; **iv)**􏰀 Need strictly positive endowments; **v)** SWT’s economic significance more limited than FWT – I’d say that the SWT is an over-rated theorem. What the SWT actually says is: **once we find an efficient allocation, we could support it with a price equilibrium**. 

But after all, **how do we find an efficient allocation**? 

- SWT has been used to say that any redistributional goals can be achieved from lump-sum reallocations of endowments and letting the market play out: **i)** Price equilibrium resulting from initial endowments may have undesirable distributional effects, even though it is Pareto optimal; **ii)** SWT says we can redistribute some endowments to disadvantaged agents so that the price equilibrium with new endowments gets us to a more favorable allocation.

Problem is most characteristics we’d want to base redistribution on are choice variables or are private information: how do we determine redistribution? Tough task.

#### Separating and Supporting Hyperplane Theorems

[**Separating Hyperplane Theorem**](https://en.wikipedia.org/wiki/Hyperplane_separation_theorem): if B,C are convex and non-empty subsets of $\mathbb{R}^L$, and their don't share any elements then $\exists$ p $\in \mathbb{R}^L$ such that: $sup \, p B ≤ inf \, p C$.

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("27.png")
 grid.raster(img)
```

[**Supporting Hyperplane Theorem**](https://en.wikipedia.org/wiki/Supporting_hyperplane): B $\subseteq \mathbb{R}^L$ is convex and that x is not an element of the interior of the set B. Then there is a p $\in \mathbb{R}^L$ with p ≠ 0 such that px ≥ py $\forall$ y $\in$ B. 

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("28.png")
 grid.raster(img)
```

Moving forward, how do we **characterize efficiency?** We use the the four assumptions to characterize Pareto Optimal allocations. We'll work with our four assumptions and for simplicity we also assume that $\forall$ x, $\triangledownu^i(x^i)$ > 0, and we normalize $u^i$(0) = 0. Let's define the **Utility Possibility Set**: $\mathcal{U}$ = {$u^1(x^1),...,u^l(x^l): x^1,...,x^l \in \mathbb{R}_+^L \sum_i x^i ≤ \omega $}. Pareto optimal allocations are on the northeast border of the UPS. Let's advance to the following problem:

\[ max_{x \in \mathbb{R}_+^{L \times I}} u^1(x_1^1,...,x_L^1) \]

s.t.

\[ u^i(x_1^i,...,x_L^i) ≥ \overline{u}^i, \text{ i = 2,...,I} \]
and
\[ \sum_i x_l^i ≤ \sum_{i} \omega_l^i, \text{ l = 1,...,L} \]

PO allocations x = ($x^1,...,x^I$) solve this program for different values of positive utility ($\overline{u}^2,...,\overline{u}^I$) ≥ 0. We maximize utility of the first consumer subject to feasibility and to other consumers getting at least some pre-specified level of utility. By **varying** the level of required utility for consumers 2,...,I we can recover the full set of PO allocations under monotonicity. 

Moving forward: suppose $x^i$ ≠ 0 $\forall$ *i*, $\implies$ ($\overline{u}^2,...,\overline{u}^I$) $\gg$ 0. Under A1,A2,A3, all the constraints must be binding $\rightarrow$ if the utility constraint for *i* were slack, we could reduce $x^i$ a little and increase $x^1$ the same amount; if the resource constraint were slack, we could increase $x^1$. Then we verify that Kuhn-Tucker theorem is applicable: $\lambda^i$ denotes the multiplier on the agent *i*'s constraint; $\mu_l$ be the constraint on commodity *l*. The Lagrangian is:

\[ \sum_i \lambda^i u^i (x^i) + \mu (\sum_i \omega^i - \sum_i x^i)    \]

Where we adopt the convention that $\lambda^1$ = 1. Since all constraints bind, $\lambda^i$ > 0, and $\mu_l$ > 0:

\[ \lambda^i \frac{\partial u^i}{\partial x_l^i} - \mu_l ≤ 0, \, x_l^i ≥ 0, \, (\lambda^i \frac{\partial u^i}{\partial x_l^i} - \mu_l)x_l^i = 0  \]
 
Plus: $\sum_i x^i = \sum_i \omega^i$. Can also interpret the Lagrangian as arising from maximizing a social welfare function: W(u) = $\sum_i \lambda^i u^i (x^i)$, subject to resource constraints.

Now, imagine we have every consumer consuming a positive quantity of every good: $x_l^i$ > 0, $\forall i,l$. KT conditions simplify to: $\frac{\partial u^i(x^i)}{\partial x_l^i} = \frac{\mu_l}{\lambda^i}$

Or: $MRS_{kl}^i = \frac{\partial u^i / \partial x_k^i}{\partial u^i / \partial x_l^i} = \frac{\partial u^j / \partial x_k^j}{\partial u^j / \partial x_l^j} = MRS_{kl}^j = \frac{\mu_k}{\mu_l}$ For every agent and commodity pair, MRS must be equal to each other and the ratio fof shadow prices $\mu_k$ and $\mu_l$.

All this FOC characterization is useful: we can link Pareto Optimal Allocations and Walrasian Equilibrium. Given utility maximization: 

\[ max_{x^i} u^i (x^i) \text{ s.t. } p x^i ≤ p \omega^i\]

Let $\gamma^i$ be the multiplier of the BC. Then to solve $UMP^i$ at given prices, we have $\forall i,l$: 
\[ \frac{\partial u^i(x^i)}{\partial x_l^i} - \gamma^i p_l ≤ 0, x_l^i ≥ 0, (\frac{\partial u^i(x^i)}{\partial x_l^i} - \gamma^i p_l)x_l^i = 0 \]

x can be supported as a price equilibrium $\iff$ we can find a price vector p and some multiplier vector $\gammma \gg$ 0 s.t. the KT conditions hold. Endowments can be taken to be $\omega^i = x^i$. **These UMP KT conditions are exactly the same as the KT conditions for PO**. 

#### [**Robinson**](https://us.sportsdirect.com/wilson-mr-wilson-castaway-volleyball-800130) [**Crusoe**](https://en.wikipedia.org/wiki/Robinson_Crusoe) Model

Let's incorporate production into the picture! Setting: **Consumer**: 1(Mr. Crusoe). **Firm**: 1(Mr. Crusoe). Both the consumer and firm act as price-takers. **Goods**: 2(leisure $x_1$, which is endowed $\overline{L}$ with (24 hours a day), and good $x_2$, that can be consumed and has 0 endowment). **Price of output**: p. **Wage rate**: w(price of labor). Production function f(z), strictly concave. 

**Firm's profit**: pf(z) - wz.  

Maximizing profit, taking prices as given, we have the following problem:

\[ z(p,w) = arg \, max_{\tilde{z}} pf(\tilde{z}) - w \tilde{z} \]

FOC: pf'(z) - w = 0. 

**Output**: q(p,w) = f(z(p,w))z; **Profit**: $\pi$(p,w) = pq(p,w) - wz(p,w). Since Robinson is the consumer and owns the firm, he receives the profit. The BC is: $px_2 ≤ w(\overline{L} - x_1) + \prod (p,w)$. Walrasian equilibrium prices ($p^\ast,w^\ast$) clear the markets:

\[ x_2(p^\ast,w^\ast) = q(p^\ast,w^\ast) \text{ [product market]} \]

\[ z(p^\ast,w^\ast) = \overline{L} - x_1(p^\ast,w^\ast) \text{ [labor market]}   \]

#### 2x2 Production Economy

Now we advance to a 2x2 economy in which there is production! Setting: **Goods**: 2. **Factors**: 2(labor and capital, input prices w and r). **Total Endowment**: L and K. The factors are produced by constant returns to scale technology. Our PMP when we have CRS is: $max pf(k,l) - c(w,r,q)$. Since $q = f(\lambda k, \lambda l)$ = $\lambda f(k,l)$ and c(w,r,q) = qc(w,r,1), if p is large we'd have unbounded profits. So since with CRS the FOC of PMP doesn't yield a level of output, it motivates us to work with "per unit" cost and factor demand. So we arrive at an equation that is: Total Cost = Unit Cost $\times$ Quantity. To denote the demands for each factor, we use: $a_l^j(w,r)$ and $a_k^j(w,r)$. 

We have arrived at [**Shepard's Lemma**](https://en.wikipedia.org/wiki/Shephard%27s_lemma): a consumer will buy a unique ideal amount of each item to minimize the price for obtaining a certain level of utility given the price of goods in the market. If indifference curves of the expenditure or cost function are convex, then the cost minimizing point of a given good *i* with price $p_i$ is unique. Formally: $\frac{\partial c^j(w,r)}{\partial w}$ = $a_l^i(w,r)$ for labor, and $\frac{\partial c^j(w,r)}{\partial r}$ = $a_k^i(w,r)$ for capital. The total amount of labor for producing $q^j$ is $a_l^jq^j$, similar rationale for capital. This is known as "full employment conditions" for economy. But what if only one good is produced? Than we have an *specialized* economy. If both goods are produced(interior solutions), then given goods prices, factor prices ($w^\ast,r^\ast$) determined by FOC:

\[ p^1 = c^1(w,r) \text{ and } p^2 = c^2(w,r) \]

We say production of good is **relatively more intensive** in labor than that of good 2 if:

\[ \frac{a_l^1(w,r)}{a_l^2(w,r)} > \frac{a_k^1(w,r)}{a_k^2(w,r)}, \forall(w,r)  \]

Now let's do what we've done a lot so far and entertain the idea of shocks to the situation we've created thus far. Let's deal with 3 scenarios:

[**1)**](https://en.wikipedia.org/wiki/Stolper%E2%80%93Samuelson_theorem) If output prices change, how do factor prices change? If $p_j$ increases, then the equilibrium price of the factor more intensively used in the production of good *j* increases, while the price of the other factor decreases.

[**2)**](https://en.wikipedia.org/wiki/Rybczynski_theorem): if endowments change, how do outputs change? If the endowment of a factor increases, then the production of the good that uses this factor relatively more intensively increases and the production of the other good decreases.

[**3)**](https://www.jstor.org/stable/2225933?seq=1#page_scan_tab_contents) Factor prices are determined by goods prices? Two countries with identical technologis facing same product prices will have same factor prices even if factor endowment differ.

#### Public Goods

Let's talk about a different type of good: **Public Goods**. This is a good that when an agent consumes it, another agent's consumption of it is not affected. They can be of two kinds: i) **excludable**: a public good that it is not costly to prevent consumption of it(ex: pay per view tv broadcasts); and ii) **non-excludable**: it is (near)impossible to prevent others from consuming it(ex: national defense). Public Goods are studied because common sense suggests that they will be under-provided by the usual market mechanism. 

**Neo-classical Theory of Public Goods**: Setting: **consumers**: i = 1,...,n. **Goods**: numeraire good and the Public Good. Each consumer *i* has utility given by $u^i(x^i,G)$. This function is differentiable, increasing in both arguments, quasi-concave and $u^i'(x^i,0) > 0$(which guarantees an interior solution). Each consumer has an endowment for the numeraire good $w^i$, so total endowment of private good is W = $\sum_i w^i$. **Public Good endowment is zero**. The **allocation** for this scenrio consists of a level of public good G and allocation of the private goods. This allocation is **feasible** if there is some z ≥ 0 s.t. i) $\sum_i x^i + z ≤ W$; ii) G ≤ f(z). The allocation of (x,G) is PO if there exists no other feasible allocation(x',G') such that: 

\[ u^i(x^i',G') ≥ u^i(x^i,G), \text{ for all i} \]

\[ u^i(x^i',G') > u^i(x^i,G), \text{ for some i} \]

[**Samuelson Condition**](https://en.wikipedia.org/wiki/Samuelson_condition): implies that further substituting public for private goods (or vice versa) would result in a decrease of social utility.
An allocation (x,G) is pareto efficient $\iff$ 

\[ \sum_{i=1}^n \frac{\partial u^i (x^i,G) / \partial G}{ \partial u^i (x^i,G) / \partial x^i} = \frac{1}{f'(z)}\]

**Market Provision of Public Good**: How much of the public good would each consumer choose to buy? The key issue is that the amount demanded by an individual consumer depends on what he expects the other consumers to demand. So this means we have a strategic problem, as opposed to a decision-theoretic problem. A **competitive equilibrium** consists of a $p^\ast$ and $G^\ast$ = ($g^{1\ast},...,g^{n\ast}$) such that: **i)** each agent's choice of $g_i$ maximizes utility given $p^\ast$ and $g_{-i}^\ast$; **ii)** the firm optimizes given p. 

**Proposition**: in the competitive equilibrium, there is under-provision of the public good relative to the level prescribed by the Samuelson condition. Intuition: each agent when deciding how much to purchase, does not consider the benefit to other agents of the output he purchased. Since this is true for each agent, the group of agents purchase less than the amount desirable for Pareto optimality. This leads to **free-riding**. How can we solve this? With...

[**Lindahl Equilibrium**](https://www.investopedia.com/terms/l/lindahl-equilibrium.asp): proposes that the individual pays for a personalized price to determine an efficient level of provision for public goods. Since market mechanisms are unlikely to provide public goods efficiently we have reason to have government involvement. The logic of Lindahl equilibrium is that each consumer faces personalized prices which induces him to choose the same level of public good. However, the Lindahl equilibrium is unrealistic in the sense that everybody faces a personalized price, which makes them demand the same level of public good - this is like perfect price discrimination.

**Conclusion of the Public Goods situation**: market mechanisms are unlikely to provide public goods efficiently; this provides a rationale for government involvement.




### **7) General Equilibrium Existence and Other Properties**

We've arrived at the final [**lecture**](https://gabrielvoelcker.netlify.com/mit/14121lecture7.pdf) of the course!



## **Useful**{.tabset}

### **Course Info**

Prof: [**Parag Pathak**](https://economics.mit.edu/faculty/ppathak)

[**Syllabus 2018**](https://gabrielvoelcker.netlify.com/mit/syllabus_fall2018.pdf)

Required readings:

- [**Microeconomic Theory - MWG**](https://gabrielvoelcker.netlify.com/mit/Mas-Colell,%20Whinston%20&%20Green%20-%20Microeconomic%20Theory.pdf)

- [**Microeconomic Theory Solutions - MWG**](https://gabrielvoelcker.netlify.com/mit/Mas-Colell, Whinston & Green - Solutions Manual for Microeconomics Theory.pdf)

- [**Microeconomic Foundations I - Kreps**](https://gabrielvoelcker.netlify.com/mit/David%20M.%20Kreps-Microeconomic%20Foundations%20I_%20Choice%20and%20Competitive%20Markets-Princeton%20University%20Press%20(2013).pdf)

### **Problem Sets Solutions**{.tabset}

#### **2017**

[**Problem Set 1**](https://gabrielvoelcker.netlify.com/mit/14.121 pset1_solutions_2017.pdf)

[**Problem Set 2**](https://gabrielvoelcker.netlify.com/mit/14.121 pset2_solutions_2017.pdf)

[**Problem Set 3**](https://gabrielvoelcker.netlify.com/mit/14.121 pset3_solutions_2017.pdf)

[**Problem Set 4**](https://gabrielvoelcker.netlify.com/mit/14.121 pset4_solutions_2017.pdf)

[**Problem Set 5**](https://gabrielvoelcker.netlify.com/mit/14.121 pset5_solutions_2017.pdf)

#### **2018**

[**Problem Set 1**](https://gabrielvoelcker.netlify.com/mit/14.121 ps1sol_2018.pdf)

[**Problem Set 2**](https://gabrielvoelcker.netlify.com/mit/14.121 ps2sol_2018.pdf)

[**Problem Set 3**](https://gabrielvoelcker.netlify.com/mit/14.121 ps3sol_2018.pdf)

[**Problem Set 4**](https://gabrielvoelcker.netlify.com/mit/14.121 ps4sol_2018.pdf)

[**Problem Set 5**](https://gabrielvoelcker.netlify.com/mit/14.121 ps5sol_2018.pdf)

[**Problem Set 6**](https://gabrielvoelcker.netlify.com/mit/14.121 ps6sol_2018.pdf)



















#### **2019**

Gabriel Voelcker 14.121 Microeconomic Theory 1

##### Problem Set 1 

1a) **Transitivity**: it is transitive. $\forall$ x,y,z $\in$ X, let x $\succeq$ y and y $\succeq$ z, then x $\succeq$ z implies transitivity. Given that "≥" is transitive in $\mathbb{R}_+$, we can assume that $\forall$ i, $x_i$ ≥ $y_i$ and $y_i$ ≥ $z_i$ and by transitivity we know that for all *i*, $x_i$ ≥ $z_i$, which implies x $\succeq$ z. 

**Completeness**: it is not complete. Proof by contradiction: given k = 2, let x = {4,2} and y = {2,4}. For i = 1, $x_1$ ≥ $y_1$, but for i = 2, $y_1$ ≥ $x_1$. It concludes that $x_i$ > $y_i$ holds for i = 1 but not for i = 2, which leads to $y_i$ > $x_i$. Since neither x $\succeq$ y nor y $\succeq$ x holds, there is a contradiction and $\succeq$ is not complete.

1b) **Reflexive**: $\succ$ is not reflexive. $\forall$ x $\in$ X, to be reflexive it would need for x $\succeq$ x **and** $\neg$ x $\succeq$ x. A statement and its negation cannot be true together, so $\succ$ is not reflexive.

**Transitive**: $\succ$ is transitive. $\forall$ x,y,z $\in$ X. Let x $\succ$ y and y $\succ$ z. So, $\forall$ i, $x_i$ ≥ $y_i$, $y_i$ ≥ $z_i$. Transitivity will hold if $x_i$ ≥ $y_i$ and $y_i$ ≥ $z_i$, then $x_i$ ≥ $z_i$. Knowing that x ≠ y ≠ z, we have x $\succ$ z.

**Symmetry**: $\succ$ is not symmetric. For $\succ$ to be symmetric, we would need x $\succ$ y and y $\succ$ x to hold. Proof by contradiction: let k = 2 and x = {2,2} and y = {1,1}, we would have that x $\succ$ y but y $\succ$ x doesn't hold, so $\succ$ is not symmetric. 

1c) **Reflexive**: ~ it is reflexive. ~ implies that $x$ ≥ $y$ and $y$ ≥ $x$ $\forall$ x,y. Thus x ~ y means that x = y. By definition, it is clear then that x ~ x.

**Transitive**: it is transitive. Let x ~ y and y ~ z, we have that x = y and y = z. We conclude that x = z and that we have transitivity, because x ~ z.

**Symmetry**: it is symmetric. If x ~ y, we have that x = y, so y ~ x.

2a) C(B) is a frequency distribution over the alternatives of B. We have 6 alternatives in B: 

$B_1$ = {x $\succ$ y $\succ$ z}

$B_2$ = {x $\succ$ z $\succ$ y}

$B_3$ = {y $\succ$ x $\succ$ z}

$B_4$ = {y $\succ$ z $\succ$ x}

$B_5$ = {z $\succ$ x $\succ$ y}

$B_6$ = {z $\succ$ y $\succ$ x}

x is preferred to y in half of the budget sets, and vice versa. The same goes for x and z and y and z. So for a stochastic choice function to be *rationalized by preferences*, we must find a probability distribution Pr over the preference relations on X such that for every budget set, the choice rule is precisely the frequency of choices induced by Pr. By assigning to $\frac{1}{6}$ to each budget set, we have a stochastic choice rationalized by preferences.

2b) On this problem, the probabilities assigned to x $\succ$ y, y $\succ$ z and z $\succ$ x are different, $\frac{1}{4}$. So, the possibility of them all happening together should ≤ $\frac{3}{4}$. However, at least one of the 3 preferences always holds, because if x $\succ$ y and y $\succ$ z don't hold, then y $\succ$ x  and z $\succ$ y, and by transitivity we have that z $\succ$ x, so the stochastic choice function is *not rationalized by preferences* since the sum of all the probabilities cannot exceed 1.

2c) $\alpha$ can gravitate only between $\frac{1}{3}$ and $\frac{2}{3}$. Because of transitivity, one of the three preference relations always holds. So the Pr(x $\succ$ y) or Pr(y $\succ$ z) or Pr(z $\succ$ x) has to equal 1. For this to be true at most, Pr(x $\succ$ y) = Pr(y $\succ$ z) = Pr(z $\succ$ x) = $\frac{1}{3}$.

By assigning a value inferior than $\frac{1}{3}$, for ex: $\frac{1}{5}$, the stochastic function ceases to be rationalized by preferences since the $\neg${x,y}, $\neg${y,z} and {z,x} will have Pr of $\frac{4}{5}$, $\frac{4}{5}$ and $\frac{1}{5}$ respectively. 

### **Exams**{.tabset}

[**2015**](https://gabrielvoelcker.netlify.com/mit/2015exam.pdf)

[**2015 solutions**](https://gabrielvoelcker.netlify.com/mit/2015exam_solutions.pdf)

[**2017**](https://gabrielvoelcker.netlify.com/mit/2017_Final Exam.pdf)

[**2018**](https://gabrielvoelcker.netlify.com/mit/examF18_wSOL_sketch.pdf)

## **MWG Takeaways** {.tabset}

### **Chapter 1 - Preference and Choice**

Individual decision problem: given a set of possible and mutually exclusive alternatives, the individual must choose between one of them. 

X: comprehends the set of alternatives. 

x,y: pairs of alternatives in X.

In order to model how individuals make decisions, we have two approaches more commonly used:

#### **1)B) Preference Relations**

In this approach, the objectives of the decision maker are summarized in a **preference relation**, which we denote by $\succeq$. We read x $\succeq$ y as "x is at least as good as y". We can derive two other important relations on the set of alternatives X:

a) The **strict preference** relation, $\succ$, defined by: x $\succ$ y $\iff$ x $\succeq$ y but y $\nsucceq$ x. This is read as "x is preferred to y".

b) The **indifference relation**, ~, defined by: x ~ y $\iff$ x $\succeq$ y $\cap$ y $\succeq$ x. This is read as "x is indifferent to y".

For much of the microeconomic theory, individual preferences are assumed to be rational. For $\succeq$ to be rational, it has to be: complete and transitive. 

- **Completeness**: $\forall$x,y $\in$ X, we have that x $\succeq$ y $\cup$ y $\succeq$ x  $\cup$ both.

- **Transitivity**: $\forall$x,y,z $\in$ X, if x $\succeq$ y $\cap$ y $\succeq$ z $\implies$ x $\succeq$ z.

Having established these two **properties** about preference relations, we identify three implications about sasuming the two properties:

i) $\succ$ is both *irreflexive* (x $\succ$ x never holds) and *transitive*(if x $\succ$ y $\cap$ y $\succ$ z $\implies$ x $\succ$ z). 

ii) ~ is **reflexive**(x ~ x $\forall$ x), **transitive**(if x ~ y $\cap$ y ~ z $\implies$ x ~ z) and **symmetric** (if x ~ y $\implies$ y ~ x).

iii) If x $\succ$ y $\succeq$ z $\implies$ x $\succ$ z.

##### **Utility Functions**

To describe these preference relations, we often use a **utility function**. This function u(x) assigns a numerical value to each element in X, ranking them in accordance to the individual's preferences. The utility function  u: X $\rightarrow$ $\mathbb{R}$ represents the relation $\succeq$ if $\forall$x,y $\in$ X, 

<center> x $\succeq$ y $\iff$ u(x) ≥ u(y) </center>

A preference relation $\succeq$ can only be represented by a utility function only if it is rational. 

#### **1)C) Choice Rules**

Now, the choice behavior itself is the primitive object of the theory. Formally, choice behavior is represented by means of a **structure choice**. A choice structure ($\mathcal{B}$,C(.)) consists of two ingredients:

i) Every element of $\mathcal{B}$ is a set B $\subset$ X. B $\in$ $\mathcal{B}$ is called *budget sets*. B should be regarded as a list of all the choice experiments possible to the decision maker.

ii) C(.) is the choice rule. It assigns a nonempty set of chosen elements C(B) $\subset$ B for every B $\in$ $\mathcal{B}$. The elements of C(B) are the **acceptable alternatives** in B. It can consist of a single element or a set of alternatives.

We also want to impose some restrictions to make the behavior reasonable. Hence, we use the **Weak Axiom of Revealed Preference**. The choice ($\mathcal{B}$,C(.)) satisfies the WARP when: if *x* is ever chosen when *y* is available, then there is no B containing both alternatives in which *y* is chosen and *x* is not. For some B $\in \mathcal{B}$ with x,y $\in$ B we have x $\in$ C(B), then for any B' $\in \mathcal{B}$ with x,y $\in$ B', we must also have x $\in$ C(B'). 

The **revealed preference relation**: given a choice structure ($\mathcal{B}$,C(.)), the RPR $\succeq^\ast$ is defined by: x $\succeq^\ast$ y $\iff$ there is some B $\in \mathcal{B}$ s.t. x,y $\in$ B and x $\in$ C(B).

We read x $\succeq^\ast$ y as *x is revealed at least as good as y*. The RPR $\succeq^\ast$ need not to be either complete or transitive.  

#### **1)D) The relationship between Preference Relations and Choice Rules**

Now we relate the two approaches with two questions:

i) if a decision maker has a preference ordering $\succeq$, do her decisions when facing choices from budget sets in $\mathcal{B}$ necessarily generate a choice structure that satisfies the weak axiom? **Yes!** If $\succeq$ is a rational preference relation, then the choice structure generated by $\succeq$, ($\mathcal{B},C^\ast(.,\succeq)$) satisfies the weak axiom.

ii) If an individual's choice behavior for a family of budget sets $\mathcal{B}$ is captured by a choice structure ($\mathcal{B}$,C(.)) satisfying the weak axiom, is there necessarily a rational preference relation that is consistent with these choices? **Maybe!** Given a choice structure ($\mathcal{B}$,C(.)), we say that the rational preference relation $\succeq$ *rationalizes C(.)* relative to $\mathcal{B}$ if: C(B) = $C^\ast$(B,$\succeq$) $\forall$ B $\in \mathcal{B}$, that is, if $\succeq$ generates the choice structure ($\mathcal{B}$,C(.)). So the weak axiom is not sufficient to ensure the existence of a rationalizing preference relation.

### **Chapter 2 - Consumer Choice**

#### Chapter 2 - Consumer Choice

**What we deal with:**

- **Commodities**: the objects of choice for the consumer.
- **Consumption set**: physical constraint that limit the consumer's choices.
- **Walrasian budget set**: economic constraints.
- **Walrasian demand function**: the consumer's choice rule.
- **Weak axiom of revealed preferences**.

The most important part of the microeconomic theory is the **consumer**. It is the decision unit. So we study the **consumer demand** in terms of the market economy, which is a setting in which the goods and services  are available for purchase at known prices. 

#### 2.B) Commodities

The decision problem of the consumer is: choose how much he wants to consume from various goods and services. These are called **commodities**. A **commodity vector** is a list of amounts of the different commodities:

$$\left[\begin{array}{cc} 
x_1 \\
... \\
... \\
x_n
\end{array}\right]$$

Rigorously: bread today ≠ bread tomorrow.

#### 2.C) The Consumption Set

The **consumption set** comprehends all the consumption bundles the individual can consume given the constraints he faces. It is a subspace of the commodity space $\mathbb{R}^L$, where L denotes the number of commodities that can be consumed. X $\subset$ $\mathbb{R}^L$ denotes the consumption set. The simplest form of consumption set is:

\[ X = \mathbb{R}^L_+ = {x \in \mathbb{R}^L : x_l ≥ 0 for \mathcal{l} = 1,...,L} \]

It denotes the set of all nonnegative bundles of commodities. It is **convex**. That means: given x,x' $\in$ $\mathbb{R}^L_+$, the bundle x'' = $\alpha$x + (1 - $\alpha$)x' is also an element of $\mathbb{R}^L_+$ for any $\alpha \in [0,1]$.

#### 2.D) Competitive Budgets

The consumer has constrains when consuming. One of the most important ones is the **affordability**. To introduce it, we formalize two assumptions:

1) The *L* commodities are traded in the market at dollar prices that are publicly quoted.

$$p = \left[\begin{array}{cc} 
p_1 \\
... \\
... \\
p_n
\end{array}\right] \in \mathbb{R}^L$$

2) **Price-taking assumption**: the consumer can't influence prices.

The affordability of a consumption bundle then depends on two things: p(prices) and w(consumer's wealth). For the consumption bundle *x*, we have:

 $px = p_1x_1 + ... + p_Lx_L ≤ w$

**Competitive budget set ($B_{p,w})**: is the set of all feasible consumption bundles for the consumer who faces market prices *p* and has wealth *w*. $B_{p,w}$ = $\{x \in \mathbb{R}^L_+: px ≤ w \}$. 

**Consumer's Problem**: given prices *p* and wealth *w*, the consumer has to choose a consumption bundle from $B_{p,w}$. The set in which **p x = w** is called the **budget hyperplane**. It is the **upper boundary of the budget set**. The budget hyperplane reflects how the **exchange** of commodities work. 

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("10.png")
 grid.raster(img)
```

The above figure illustrates the geometric relationship between p and the budget hyperplane.

#### 2.E) Demand Functions and Comparative Statics

You can have **more than one** Walrasian Demand Correspondence. That is, **any consumption bundle x(p,w) might be chosen** by the consumer when he faces price-wealth pair (p,w). When x(p,w) is single-valued, we refer to it as a *demand function*. 

**Homogeneous of degree zero**: if both prices(p) and wealth(w) change in the same proportion, then the individual's consumption choice does not change. Mathematically: x($\alpha$p,$\alpha$w) = x(p,w) $\forall$ p,w and $\alpha$ > 0.

**Walras' Law**: the consumer fully expends his wealth. The WDC satistifies Walras' Law if $\forall$ p >> 0 and w > 0, we have px = w $\forall$ x $\in$ x(p,w). 

##### **Comparative Statics**

How does the consumer's choice vary with changes in *w* and *p*? **Comparative Statics** analyzes how a change in the economic parameters affects the outcome.

**Wealth effects:** 

- **Engel function**: given fixed prices $\overline{\rm p}$, the image in $\mathbb{R}^L_+$, $E_{\overline{\rm p}}$ = $\{ x(\overline{\rm p},w): w > 0\}$ is known as the wealth expansion path:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("11.png")
 grid.raster(img)
```

At any (p,w) the derivative $\frac{\partial x_l(p,w)}{\partial w}$ is known as the wealth effect for the *l*$_{th}$ good. If this derivative is ≥ 0, the commodity is *normal* at (p,w). That is, the demand is nondecreasing in wealth. If every commodity at (p,w) is normal, then the **demand is normal**. Matrix wise, the wealth effects can be represented as:

$$D_w x(p,w) = \left[\begin{array}{cc} 
\frac{\partial x_1 (p,w)}{\partial w} \\
\frac{\partial x_2 (p,w)}{\partial w} \\
... \\
\frac{\partial x_L (p,w)}{\partial w}
\end{array}\right] \in \mathbb{R}^L$$

As w varies, how does it affect demand?

**Price effects:** complementing: how the consumption levels are affected when **prices** vary? The derivative $\frac{\partial x_l(p,w)}{\partial p_k}$ denotes the **price effect** of $p_k$, the price of good *k* on the demand for good $l$. 

##### Implications of Homogeneity and Walras' Law for Price and Wealth Effects

- **Homogeneity of degree zero**: we know that x($\alpha p$, $\alpha w$) - x(p,w) = 0 $\forall \al \alpha$ > 0. This implies that the price and wealth derivatives of demand for any good $l$, when weighted by these prices and wealth, sum to zero. We arrive at the results of propositon 2E1, that will eventually state the implications of homogeneity of degree zero for comparative statics: 

\[ \sum_{k=1}^L \frac{\partial x_l (p,w)}{\partial p_k}p_k + \frac{\partial x_l(p,w)}{\partial w}w = 0  \]

For $l$ = 1,...,L. In matrix, this is: $D_p x(p,w)p$ + $D_w x(p,w)w$ = 0.

If we think in terms of the elasticities:

\[ \varepsilon_{lk}(p,w) = \frac{\partial x_l(p,w)}{\partial p_k} \frac{p_k}{x_l(p,w)} \]

\[ \varepsilon_{lw}(p,w) = \frac{\partial x_l(p,w)}{\partial p_w} \frac{p_w}{x_l(p,w)} \]

These two equations give the *percentage* change in **demand for good $l$** per (marginal) percentage change in the price of good *k* or wealth; note that the expression for $\varepsilon_{lw}(.,.)$ can be read as $(\frac{\Delta x}{x})$/$(\frac{\Delta w}{w})$. If we apply the elasticities to the formula from proposition 2E1 we arrive at:

\[ \sum_{k=1}^L \varepsilon_{lk}(p,w) + \varepsilon_{lw}(p,w) = 0 \] 

For $l$ = 1,...,L. This expresses the comparative statics implication of homogeneity of degree zero: an equal % change in all prices and wealth leads to no change in demand.

- **Walras' Law**: we know that px(p,w) = w $\forall p,w$. Differentiating this with respect to price yields the proposition 2E2: If the Walrasian demand function x(p,w) satisfies Walras' Law, then $\forall p,w$:

\[ \sum_{l=1}^L p_l \frac{\partial x_l(p,w)}{\partial p_k} + x_k(p,w) = 0 \] 

For k = 1,...,L. This is called the **property of Cournot aggregation**: the total expenditure can't change in response to a change in prices. When we differentiate with respect to w, we get to proposition 2E3: If the Walrasian demand function x(p,w) satisfies Walras' Law, then $\forall p,w$: 

\[ \sum_{l=1}^L p_l \frac{\partial x_l(p,w)}{\partial w} = 0 \]

Which is called the **property of Engel aggregation**: total expenditure must change by an amount equal to any wealth change.

#### 2.F) The Weak Axiom of Revealed Preference and the Law of Demand

What are the implications of WARP(1C) for consumer demand? 

**Definition 2F1**: the Walrasian demand function x(p,w) satisfies the WARP if the following holds for any (p,w) and (p',w'):

\[ if \, px(p',w') ≤ w \, \cap \, x(p'.w') ≠ x(p,w) \implies p' x(p,w) > w'  \]

This relates to the definition of WARP in 1C. Translating into the consumer demand setting: if px(p',w') ≤ w and x(p',w') ≠ x(p,w), then we know that when facing prices *p* and wealth *w*, the consumer will choose x(p,w) even though x(p',w') was also available. So, when consumer chooses x(p',w'), then the bundle x(p,w) must not be affordable. That is, as required by WARP, we must have p'x(p,w) > w'. 

##### **Implications of WARP**

Price changes affect the consumer in two ways: 1) they alter the relative cost of different commodities; 2) they change the consumer's *real* wealth. We need to isolate the increase in price of a commodity to understand its impact in the consumers' wealth. 

**Slutsky's Wealth Compensation**: imagine a change in prices accompanied by a change in wealth in order that the original consumption bundle is just affordable at the new prices. So if the initial choice was x(p,w) and p $\rightarrow$ p', then the consumer's wealth is adjusted to w' = p'x(p,w). The wealth adjustment is $\Delta w$ = $\Delta p$x(p,w). This compensated price change is illustrated by:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("12.png")
 grid.raster(img)
```

We refer to price changes that are accompanied by such compensating wealth changes as (Slutsky) compensated price changes. We can show that the weak axiom can also be staed in terms of the demand response to compensated price changes:

**Proposition 2F1**: suppose that the Walrasian demand function x(p,w) is homogeneous of degree zero and satisfies Walras' law. Then x(p,w) satisfies the weak axiom only if **for any compensated $\Delta p$ from an initial (p,w) to a new (p',w') = (p',p'x(p,w)) we have:

\[ (p'-p)[x(p',w') - x(p,w)]  ≤ 0 \]

with strict inequality whenever x(p,w) ≠ x(p',w'). This inequality (2F1) can be interpreted as a form of the **law of demand**: *demand and price move in opposite directions*. It tells us that the law of demand holds for *compensated* price changes. We call it the **compensated law of demand**. 

For ex: imagine the $p_l$ changes, what's the effect on demand? We have $\Delta p$ = (0,...,0,$\Delta p$,0,...,0). Since $\Delta p$ $\Delta x$ = $\Delta p_l$ $\Delta x_l$. The proposition 2F1 tells us that if $\Delta p_l$ > 0, then we must have $\Delta x_l$ < 0. This is illustrated by: 

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("13.png")
 grid.raster(img)
```

The first figure shows how the budget line rotates when a decrease in price of the good 1 is compensated. The second figure has no compensation, so the demand for good 1 can fall.

**Slutsky's Matrix**: its elements are known as *substitution effects* because the term $s_{lk}(p,w)$ mesaures the differential change in the consumption of commodity *l* due to a differential change in the price of commodity *k* when wealth is adjusted so that the consumer can still just afford his original consumption bundle. To arrive at Slutsky's matrix: start at a (p,w) and suppose a differential chance in prices *dp*. Imagine that we make this a compensated price change by giving the consumer compensation of *dw* = *x(p,w)dp* (which is the differential analog of $\Delta w$ = x(p,w)$\Delta p$). By 2F1, we know that dp dx ≤ 0. The differential change in demand induced by this compensated price change is: 

\[ dx = D_px (p,w)dp + D_w x(p,w)dw\]

Which is

\[ dx = D_p x(p,w)dp + D_w x(p,w)[x(p,w)dp] \]

or equivalently, in a matrix format:

\[ dx = [D_px(p,w) + D_wx (p,w)x(p,w)^T] dp\]

Using the dx above and plugging it into dp dx ≤ 0, we have:

\[ dp [D_px(p,w) + D_wx (p,w)x(p,w)^T] dp ≤ 0 \]

The expression in the middle of brackets is the following matrix:

$$S(p,w) = \left[\begin{array}{cc} 
s_{11} & \dots & s_{1L}(p,w)\\
\vdots & \vdots & \vdots \\
s_{L1}(p,w) & \dots & s_{LL}(p,w)
\end{array}\right]$$

where the ($l$,k)th entry is

\[ s_{lk}(p,w) = \frac{\partial x_l (p,w)}{\partial p_k} + \frac{\partial x_l(p,w)}{\partial w} x_k(p,w) \]

That's how we arrive at the term that measures the differential change in the consumption of commodity $l$ due to a differential change in the price of commodity $k$ when wealth is adjusted so that the consumer can still just afford his original consumption bundle: $s_{lk}(p,w)$. This is summarized in Proposition 2F2:

If a differentiable Walrasian demand function x(p,w) satisfies Walras' Law, Homogeneity of degree zero and the weak axiom, then at any (p,w) the Slutsky matrix S(p,w) satisfies v S(p,w)v ≤ 0 $\forall$ v $\in$ $\mathbb{R}^L$.

Given that the substitution effect of good *l* with respect to its own price is always nonpositive. A matrix that satisfies this is called **negative semi-definite** (see appendix MD). S(p,w) being negative semi-definite implies that $s_{ll}(p,w)≤0$.

Lastly, Proposition 2.F.3. states that: when the Walrasian demand function x(p,w) is differentiable, homogeneous of degree 0 and satisfies Walras' Law, then p S(p,w) = 0 and S(p,w)p = 0 $\forall$(p,w). This proposition implies that S(p,w) is always singular $\implies$ the negative semidefiniteness can't be extended to negative definiteness.

**Summarizing 2F:**

i) The consistency requirement of WARP is equivalent to the compensated law of demand.

ii) The compensated law of demand, in turn, implies negative semidefiniteness of the substitution matrix S(p,w).

iii) These assumptions do not imply symmetry of S(p,w), except when L = 2.

### **Chapter 3 - Classical Demand Theory**

#### **Chapter 3**

Preference-based approach to consumer demand:

B) Consumer's relation and basic properties(monotonicity{LNS} and convexity).

C) Continuity properties of utility funcions that represent the consumer's preferences.

D) Consumer's problem framed as utilitiy maximization problem (price-taking assumption) focus on: consumer's optimal choice(embodied in the Walrasian demand correspondence) and the consumer's optimal utility value (captured by indirect utility function).

E) Expenditure minimization problem. 

F) mathematical underpinnings of duality theory.

G) Results of demand theory: connect demand and value functions.

H) Integrability problem.

I) Start welfare analysis.

J) Strong axiom of revealed preference.

#### 3.B) Preference Relations: Basic Properties

We start by specifying the consumer's preferences given the bundles in the consumption set X $\subset$ $\mathbb{R}_+^L$. We assume that the consumer's preferences are captured by $\succeq$ that is rational (i.e. complete and transitive). We use another two assumptions about preferences:

**i) Desirability**: larger amounts $\succeq$ smaller amounts. It is called **monotone** if x $\in$ X and y $\gg$ x implies that y $\succeq$ x. It is **strongly monotone** y $\gg$ x and y ≠ x. This implies that we are talking about "goods" rather than "bads". 

**Definition 3B3**: the preference relation $\succeq$ on X is **locally nonsatiated** if $\forall$ x $\in$ X and every $\varepsilon$ > 0, there is y $\in$ X such that ||y - x|| ≤ $\varepsilon$ and y $\succ$ x. 

**Indifference set** containing point x is the set of all bundles that are indifferent to x, formally it is {y $\in$ X: y ~ x}.

**Upper contour set** of bundle x is the set of all bundles that are at least as good as x:{y $\in$ X: y $\succeq$ x}.

**Lower contour set** of x is the set of all bundles that x is at least as good as {y $\in$ X: x $\succeq$ y}.

**ii) Convexity assumptions**: concerns the trade-offs that the consumer is willing to make. Definition 3B4: the preference relation $\succeq$ on X is *convex* if for every x $\in$ X, the upper contour set {y $\in$ X: y $\succeq$ x} is convex; that is, if y $\succeq$ x and z $\succeq$ x, then $\alpha$y + (1 - $\alpha$)z $\succeq$ x for any $\alpha$ $\in$ [0,1]. 

Convexity is a strong but central hypothesis in economics. It can be interpreted in terms of **diminishing marginal rates of substitution**: with convex preferences from any initial consumption situation x, and for any two commodities, it takes increasingly larger amounts of one commodity to compensate for successive unit losses of the other. Convexity can also be viewed as the formal expression of a basic inclination of economic agents for diversification.  

It is common to focus on preferences for which it is possible to deduce the consumer's entire preference relation from a single indifference set. Two examples are the classes of **homethetic** and **quasilinear** preferences.

**Homothetic**(3B6): a monotone preference relation $\succeq$ on X = $\mathbb{R}_+^L$ is *homothetic* if all indifference sets are related by proportional expansion along rays; that is, if x ~ y, then $\alpha$x ~ $\alpha$y $\forall$ $\alpha$ ≥ 0. 

An illustration of homothetic preferences:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("15.png")
 grid.raster(img)
```

**Quasilinear**(3B7): $\succeq$ on X = ($- \infty,\infty$) $\times$ $\mathbb{R}_+^{L-1}$ is quasilinear with respect to commodity 1(aka the **numeraire** commodity) if:

i) If x ~ y, then (x + $\alpha e_1$) ~ (y + $\alpha e_1$) for $e_1$ = (1,0,...,0) and any $\alpha \in \mathbb{R}$. So, all indifference sets are parallel displacements of each other along the axis of commodity 1.

ii) Good 1 is desirable; that is, x + $\alpha e_1 \succeq x$ $\forall x$ and $\alpha > 0$.

An illustration of homothetic preference relation:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("14.png")
 grid.raster(img)
```

As we can see, how much we consume of $x_1$ and $x_2$ have a different impact on the utility function. The more $x_1$, the better. 

#### 3.C) Preference and Utility

It is helpful to summarize the consumer's behavior using a utility function. When can this be done? We begin by introducing the continuity assumption.

**Lexicographic Preference Relation**: assume that X = $\mathbb{R}_+^2$. Given two commodities, the first one has the highest priority in determining the preference order. So, if x $\succeq$ y, then either $x_1 > y_1$ or $x_1 = y_1$ and $x_2 ≥ y_2$. This remembers how the dictionary works. A word beginning with "A" always comes before one that starts with "B", but if both words begin with "A", we turn to the second letter in order to figure out which is ordered first. This preference relation is **not continuous**.

**Continuous Preference Relation**(3C1): in order for a utility function to exist, it has to be **continuous**. Continuity implies that **the consumer's preferences cannot exhibit "jumps"**. Formally, $\succeq$ on X is *continuous* if it is preserved under limits. That is, for any sequence of pairs {($x^n,y^n$)}$_{n=1}^\infty$ with $x^n \succeq y^n$ $\forall n$, x = $lim_{n \rightarrow \infty} x^n$ and y = $lim_{n \rightarrow \infty} y^n$ we have x $\succeq$ y. 

**Continuity of Preference Relation implies Continuity of Utility Function**(3C1): continuity of $\succeq$ is sufficient for the existence of a utility function representation. Pf:

But the utility function is not unique: any strictly increasing transformation of u(.), say v(x) = f(u(x)), where f(.) is a strictly increasing function, also represents $\succeq$. Proposition 3C1 tells us that if $\succeq$ is continuous, there exists some continuous utility function representing $\succeq$. It is possible for continuous preferences not to be representable by a differentiable utility function, for ex: the Leontief preferences. 

Some properties of preferences($\succeq$) can be translated to utility functions(u(.)). For example: **restrictions** on preferences translate into restrictions on the form of utility functions. The property of monotonicity, for example, implies that the utility function is increasing: u(x) > u(y) if x $\gg$ y.

**Quasiconcavity**: a utility function u(.) is quasiconcave if the set ${u \in \mathbb{R}_+^L : u(y) ≥ u(x) }$ is convex $\forall$ x or, if $u(\alpha x + (1 - \alpha)y)$ ≥ Min${u(x), u(y)}$ $\forall x,y$ and $\forall \alpha \in [0,1]$. So, the property of convexity of preferences implies that u(.) is quasiconcave. u(.) is quasiconcave if the set {y $\in$ $\mathbb{R}_+^L$: u(y) ≥ u(x)} is convex for all x or, equivalently, if u($\alpha$x + (1 - $\alpha$)y) ≥ Min{u(x),u(y)} for any x,y and all $\alpha \in$ [0,1].

Monotonicity and convexity of $\succeq$ imply that all utility functions of $\succeq$ are increasing and quasiconcave.  

#### 3.D) Utility Maximization Problem

We assume throughout that the consumer has a rational, continuous and locally nonsatiated preference relation, and we take u(x) to be a continuous utility function representing these preferences. The consumption set is X = $\mathbb{R}^L_+$. The consumer problem is choosing the most preferred bundle given prices p $\gg$ 0 and wealth w > 0, which can now be stated as the *Utility Maximization Problem*(UMP):

\[  Max_{x≥0}u(x) s.t. px ≤ w \]

In the UMP, the consumer chooses a consumption bundle in the Walrasian budget set $B_{p,w}$ {$x \in \mathbb{R}^L_+ : px ≤ w$} to maximize her utility. 

**UMP has a solution**: if p $\gg$ 0 and u(.) is continuous, then the utility maximization problem has a solution. 

Proof: given that the budget set $B_{p,w}$ = {$x \in \mathbb{R}^L_+: px ≤ w$} is a **compact set** because it is both **bounded** and **closed**. Since a **continuous function always has a maximum value on any compact set**, the utility maximization problem has a solution. Given the illustration below, you can have more than one solution:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("16.png")
 grid.raster(img)
```

Given that **every utility function has a solution**, we turn to two problems that emerge from the UMP:

1) The consumer's set of optimal consumption bundles (the solution of the UMP).

2) The consumer's maximal utility value (the value function of the UMP).

##### **Walrasian Demand Correspondence**:

**Walrasian Demand Correspondence**: is the set of optimal consumption vectors in the UMP, denoted by x(p,w) $\in \mathbb{R}_+^L$. x(p,w) can represent a point or have more than one element, as the figure above illustrates. When it is single valued for all (p,w), we refer to it as the **Walrasian demand function**. If u(.) is a continuous utility function, representing a LNS preference relation $\succeq$ defined on the consumption set X = $\mathbb{R}^L_+$, then it has the following properties:

i) **Homogeneity of degree zero** in (p,w): x($\alpha$p, $\alpha$w) = x(p,w) $\forall$p,w, and scalar $\alpha$ > 0.

ii) **Walras' Law**: px = w $\forall$ x $\in$ x(p,w). Total consumption!

iii) **Convexity/uniqueness**: if $\succeq$ is convex, so that u(.) is quasiconcave, then x(p,w) is a convex set. Moreover, if $\succeq$ is **strictly convex**, so that u(.) is **strictly quasiconcave**, then **x(p,w) consists of a single element**. 

See book(pg 52) for Proof of the three properties. 

**Kuhn-Tucker conditions**: if there is a x$\ast$ $\in$ x(p,w) as a solution to the UMP, then there exists a *Lagrange Multiplier* ≥ 0 s.t. $\forall$ l = 1,...,L:

\[ \frac{\partial u(x*)}{\partial c_l} ≤ \lambda p_l   \]

with equality if $x^*_l$ >0.

The gradient vector of u(.) at x is denoted by $\triangledown$u(x) = [$\frac{\partial u(x)}{\partial x_1},...,\frac{\partial u(x)}{\partial x_L}$]. So the above equation could be writen in matrix notation as

\[ \triangledown u(x^{\ast}) ≤ \lambda p\]

and

\[ x^{\ast}[\triangledown u(x^{\ast})- \lambda p] = 0 \]

Thus, if we are at an interior optimum(x $\gg$ 0), we must have

\[ \triangledown u(x^{*}) = \lambda p  \]

This tells us that an interior optimum, the gradient vector of the consumer's utility function $\triangledown$u(x) must be proportional to the price vector *p*. If $\triangledown$u($x^{*}$) $\gg$ 0, this is equivalent to the requirement that for any two goods *l* and *k* we have

\[ \frac{\partial u(x^*)/\partial x_l}{\partial u(x^*)/ \partial x_k} = \frac{p_l}{p_k}    \]

The **marginal rate of substitution** of good *l* for good *k* at $x^*$($MRS_{lk}(x^*)$) is the left side of the equation above. It tells us the amount of good *k* that the consumer must be given to compensate her for a one-unit marginal reduction in her consumption of good *l*.

The $\lambda$ is the **consumer's marginal utility of wealth**. It equals the consumer's marginal utility value of wealth at the optimum. To see this, consider for simplicity the case where x(p,w) is a differentiable function and x(p,w) $\gg$ 0. The change in utility from a marginal increase in *w* is given by $\triangledown$u(x(p,w)) $\circ$ $D_w$x(p,w), where $D_w$x(p,w) = [$\frac{\partial x_1(p,w)}{\partial w},...,\frac{\partial x_L (p,w)}{\partial w}$]. Substituting for $\triangledown$u(x(p,w)) from previous equations, we get:

$\triangledown$u(x(p,w)) $\circ$ $D_w x(p,w)$ = $\lambda p$ $D_w x(p,w)$ = $\lambda$

This holds because px(p,w) = w $\forall$ w (Walras' Law), and therefore p$\circ$ $D_wx(p,w)$ = 1.

Ex 3D1: **The Demand Function Derived from the Cobb-Douglas Utility Function**: A CD for L=2 is given by u($x_1,x_2$) = $kx_1^\alpha x_2^{1-\alpha}$ for some $\alpha \in (0,1)$ and k > 0. It is increasing at all ($x_1,x_2$) $\gg$ 0 and is homogeneous of degree one. It is easier to use the increasing linear transformation $\alpha ln x_1 + (1 - \alpha)ln x_2$ as the utility function. 

\[ Max_{x_1,x_2} \alpha ln x_1 + (1 - \alpha)ln x_2 \]

s.t. $p_1x_1 + p_2x_2$ = w. 

Since ln 0 = -$\infty$, the optimal choice ($x_1(p,w)$), ($x_2(p,w)$) is strictly positive and must satisfy the first-order conditions(we write the consumption levels simply as $x_1,x_2$):

\[ \frac{\alpha}{x_1} = \lambda p_1 \]

\[ \frac{1 - \alpha}{x_2} = \lambda p_2 \]

For some $\lambda$ ≥ 0, and the budget constraint px(p,w) = w.

\[ p_1x_1 = \frac{\alpha}{1 - \alpha}p_2x_2 \]

or

\[ p_1x_1 = \frac{\alpha}{1 - \alpha}(w - p_1x_1) \]

Hence: 

\[ x_1(p,w) = \frac{(1 - \alpha)w}{p_2} \]

In the CD utility function, the expenditure on each commodity is a constant fraction of wealth for any price vector *p*.

##### **Indirect Utility Function** 

**Indirect Utility Function**: is an analytical tool that assesses for each value (p,w) $\gg$ 0, the utility value of the UMP is denoted v(p,w) $\in \mathbb{R}$. It is equal to u($x^*$) $\forall$ $x^* \in x(p,w)$. 

Suppose tht u(.) is a continuous utility function representing a LNS preference relation $\succeq$ defined on the consumption set X = $\mathbb{R}^L_+$. The indirect utility function is:

i) Homogeneous of degree zero.

ii) Strictly increasing in *w* and nonincreasing in $p_l$ for any $l$.

iii) Quasiconvex: the set {(p,w): v(p,w) ≤ $\hat{v}$} is convex $\forall \hat{v}$.

iv) Continuous in *p* and *w*.

#### 3.E) Expenditure Minimization Problem

This section studies the EMP for p $\gg$ 0 and u > u(0): 

\[ Min_{x ≥ 0}\, p x |  u(x) ≥ u \]

The **EMP computes the minimal level of wealth required to reach utility level u**. It is the dual problem to the UMP.  

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("17.png")
 grid.raster(img)
```

The consumption bundle x* is the least costly bundle that still allows the consumer to achieve u. Graphwise, is the point in the set {x $\in$ $\mathbb{R}^L_+$: u(x) ≥ u}. 

**EMP properties**: given that u(.) is a continuous utility function representing a LNS $\succeq$ defined on the consumption set X = $\mathbb{R}_+^L$ and that the price vector is p $\gg$ 0, then:

i) If x\* is optimal in the UMP when wealth is w > 0, then x\* is optimal in the EMP when the required utility level is u(x\*) and the minimized expenditure level in this EMP is exactly w.

ii) If x\* is optimal in the EMP when the required utility level is u > u(0), then x\* is optimal in the UMP when wealth is px\* and the maximized utility level is u.

We now proceed to study the optimal consumption vector and the value function of the EMP. We consider the value function first.

##### **The Expenditure Function**

The **Expenditure Function** is given by e(p,u). It is assumed: *a)* prices p $\gg$ 0; *b)* required utility level u > u(0); *c)* u(.) is a continuous utility function representing a LNS defined on the consumption set X = $\mathbb{R}^L_+$. Its value for any (p,u) is simply px\*, where x\* is any solution to the EMP. The basic properties of the EF are:

i) Homogeneous of degree one in *p*.

ii) Strictly increasing in *u* and nondecreasing in $p_l$ for any $l$.

iii) Concave in p.

iv) Continuous in *p* and *u*.

Connecting the expenditure function and the indirect utility function: $\forall$ p $\gg$ 0, w > 0 and u > u(0), we have

\[ e(p,v(p,w)) = w \, and \, v(p,e(p,u)) = u \]

These conditions imply that for a fixed price vector $\tilde{p}$, $\e(\tilde{p},.)$ and $v(\tilde{p},i)$ are inverses to one another. 

##### **The Hicksian(Compensated) Demand Function**

The set of **optimal commodity vectors in the EMP is denoted h(p,u)** $\subset$ $\mathbb{R}_+^L$, and is known as the **Hicksian(compensated) demand correspondence(function if single valued)**. 

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("18.png")
 grid.raster(img)
```

The Hicksian parallels the Walrasian demand. Given that u(.) is a continuous utility function representing a LNS preference relation $\succeq$ defined on the consumption set X = $\mathbb{R}^L_+$. Then, for any p $\gg$ 0, the Hicksian demand correspondence h(p,u) has the following properties: 

i) Homogeneity of degree zero in p: h($\alpha$p,u) = h(p,u) $\forall$ p,u and $\alpha$ > 0.

ii) **No excess utility**: for any x $\in$ h(p,u), u(x) = u.

iii) **Convexity/uniqueness**: if $\succeq$ is convex, then h(p,u) is a convex set; and if $\succeq$ is strictly convex, so that u(.) is strictly quasiconcave, then there is a unique element in h(p,u).

Just as in the UMP the **optimal consumption bundle in the EMP can be characterized using first-order conditions**. Using proposition 3E1 we can relate the Hicksian and Walrasian demand correspondences as follows: 

\[ h(p,u) = x(p,e(p,u)) \, and \, x(p,w) = h(p,v(p,w))  \]

**Compensated demand correspondence**: as prices vary, h(p,u) gives precisely the level of demand that would arise if the consummer's wealth ere simultaneously adjusted to keep her utility level at u. This is known as the **Hicksian Wealth Compensation**. Let's illustrate:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("19.png")
 grid.raster(img)
```

Starting fromm the the price-wealth pair (p,w), prices change to p', where $p_1'$ = $p_1$ and $p_2'$ > $p_2$. The Hicksian wealth compensation is the amount $\Delta w_{Hicks}$ = e(p',u) - w. Thus, the demand function h(p,u) keeps the consumer's utility level fixed as prices change, in contrast with the Walrasian demand function, which keeps money wealth fixed but allows utility to vary. 

##### **Hicksian Demand and the Compensated Law of Demand**

An important property of Hicksian demand is that it satisfies the **compensated law of demand**: Demand and Price Move in **opposite directions** for price changes that are accompanied by Hicksian wealth compensation. Given u(.) CUF representing a LNS $\succeq$ and that h(p,u) consists of a **single element** $\forall$ p $\gg$ 0. Then the Hicksian demand function h(p,u) satisfies the compensated law of demand: for all p' and p'':

(p'' - p')[h(p'',u)-f(p',u)] ≤ 0.

For more, see Proof and Cobb-Douglas example.

#### 3.F) Duality: A Mathematical Introduction

#### 3.G) Relationships between Demand, Indirect Utility, and Expenditure Functions

#### 3.H) Integrability

#### 3.I) Welfare Evaluation of Changes

#### 3.J) Strong Axiom of Revealed Preferences


### **Chapter 4 - Aggregate Demand**

#### **Chapter 4**

Extends the theory of chapters 1-3 to **aggregate demand**. 3 questions about aggregate demand:

1) When can aggregate demand be expressed as a function of prices and aggregate wealth?(of interest to the econometrician)

2) When does aggregate demand satisfy the weak axiom?(to the positive theorist)

3) When does aggregate demand have welfare significance?(to the welfare theorist)

#### **4B Aggregate Demand and Aggregate Wealth**

Setting: *I* consumers with rational preference relations$\succeq_i$ and corresponding Walrasian demand function $x_i(p,w_i)$. Given prices $p \in \mathbb{R}^L$ and wealth levels ($w_1,...,w_I$).

**Aggregate Demand can be written as**: 

\[ x(p,w_1,...,w_I) = \sum_{i=1}^I x_i(p,w_i) \]

Aggregate demand depends on: *prices* and *wealth levels*. So, when does aggregate demand depends only on aggregate wealth? (so that the above formula becomes: x(p,$\sum_i w_i$)) $\rightarrow$ when however you distribute wealth among consumers is not relevant. If AD can be written as a function of aggregate wealth, then assuming differentiability of the demand functions, we have:

\[ \sum_i \frac{\partial_{li}(p,w_i)}{\partial w_i}dw_i = 0 \text{ for every l} \]

The invariance of the aggregate demand relating to redistribution:

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("23.png")
 grid.raster(img)
```

Implies wealth expansion paths that are straight and parallel across consumers. 

**Proposition 4B1**: a necessary and sufficient condition for the set of consumers to exhibit parallel, straight wealth expansion paths at any price vector *p* is that preferences admit indirect utility functions of the Gorman form with the coefficients on $w_i$ the same for every consumer $i$:

\[ v_i(p,w_i) = a_i(p) + b(p)w_i \]

So, Aggregate Demand can be written as a function of aggregate wealth $\iff$ all consumers have preferences that admit indirect utility functions of the Gorman form with equal wealth coefficients $b(p)$.

When individual wealth levels are generated by a wealth distribution rule, we can indeed *always* write aggregate demand as a function x(p,w) = $\sum_i x_i(p,w_i(p,w))$, and so aggregate demand depends only on prices and aggregate wealth. 

#### **4C Aggregate Demand and the Weak Axiom**

#### **Aggregate Demand and the Existence of a Representative Consumer**

When can we treat the Aggregate Demand function as if it were generated by a fictional *representative consumer*  whose preferences can be used as a measure of aggregate societal (or social) welfare?

This *representative consumer* exists when there is a rational preference relation $\succeq$ on $\mathbb{R}^L_+$ such that the aggregate demand function **x(p,w)** is precisely  the Walrasian demand function generated by this preference relation. That is, x(p,w) $\succ$ x whenever x $\neq$ x(p,w) and px ≤ w. Informally: a positive representative consumer would be one whose utility maximization problem would lead to the economy's aggregate demand function. This is not sufficient. We also need to address the **social welfare function**. 

**Definition 4D2**: a social welfare function is a function W:$\mathbb{R}^I \rightarrow \mathbb{R}$ that assigns a utility value to each possible vector ($u_1,...,u_I$) $\in \mathbb{R}^I$ of utility levels for the *I* consumers in the economy. 

The idea behind this **social welfare function** is that it expresses society's judgements on how individual utilities have to be compared to produce an ordering of possible social outcomes.

**Proposition 4D1**: for each level of prices *p* and aggregate wealth *w*, the wealth distribution solves the social welfare maximization problem. Then the value function v(p,w) is an indirect utility function of a positive representative consumer for the aggregate demand function: $x(p,w) = \sum_i x_i (p,w_i(p,w))$.


**Definition 4D3**: a *normative representative consumer* relative to the social welfare function is the one that for every (p,w), the distribution of wealth ($w_1(p,w),...,w_I(p,w)$) solves the social welfare maximization problem and therefore the value function of this problem is an indirect utility function for $\succeq$. 

### **Chapter 5 - Production**

Transition to the supply side of the economy: **how are the goods and services produced?** We care about: what can the firm do?

#### **5.B - Production Sets**

Setting: *L* commodities. A *production vector* is a vector y = ($y_1,...,y_L$) $\in \mathbb{R}^L$ that describes the (net) outputs of the L commodities from a production process. Positive numbers $\rightarrow$ outputs; Negative numbers $\rightarrow$ inputs.

**Production Set**: is the set of all production vectors that constitute feasible plans for the firm. Denoted by $Y \subset \mathbb{R}^L$. Sometimes we describe Y using a function F(.) called the *transformation function*. The transformation function F(.) has the property that Y = $\{ y \in \mathbb{R}^L : F(y) ≤ 0 \}$ and F(y) = 0 if and only if *y* is an element of the boundary of Y. The set of boundary points of *Y*, $\{ y \in \mathbb{R}^L : F(y) = 0 \}$ is known as the *transformation frontier*. 

If F(.) is differentiable, and if the production vector $\hat{y}$ satisfies F($\hat{y}$) = 0, then for any commodities $l$ and $k$, the ratio:

\[ MRT_{lk}(\hat{y}) = \frac{\frac{\partial F(\hat{y})}{\partial y_l}}{\frac{\partial F(\hat{y})}{\partial y_k}}\] 

Is called the marginal rate of transformation (MRT) of good *l* for good k at $\hat{y}^{-1}$. It denotes if you produce less K, how much more you can produce of L.

##### **Technologies with Distinct Inputs and Outputs**

Sometimes it's convenient to distinguish the firm's inputs and outputs. Notation is used for that. A single-output technology is commonly described by means of a *production function* f(z) that gives the maximum amount q of output that can be produced using input amounts ($z_1,...,z_{L-1}$) ≥ 0. The marginal rate of technical substitution (MRTS) of input *l* for input k at $\hat{z}$ as 

\[ MRTS_{lk} (\hat{z}) = \frac{\frac{\partial f(\hat{z})}{\partial z_l}}{\frac{\partial f (\hat{z})}{\partial z_k}}   \]

If you get one less unit of L how much more K do you need to maintain the level of output equal? The number $MRTS_{lk}(\hat{z})$ measures the additional amount of input K that must be used to keep output at level $\hat{q}$ = f($\hat{z}$) when the amount of input L is decreased marginally. 

##### **Properties of Production Sets**

i) Y is nonempty.

ii) Y is closed. The set includes its boundary.

iii) No free lunch: you can't produce an output without using an input.

iv) Possibility of inaction: complete shutdown is possible.

v) Free disposal: the absorption of any additional amounts of inputs without any reduction in output is always possible. 

vi) Irreversibility.

vii) Nonincreasing returns to scale: any feasible input-output vector can be scaled down.

viii) Nondecreasing returns to scale: any feasible input-output vector can be scaled up.

ix) Constant returns to scale: vii + viii.

x) Additivity(free entry): if y and y' are both possible, then one can set up two plants that do not interfere with each other and carry out production plans independently. 

xi) Convexity.

xii) Y is a convex cone.

**Proposition 5B1**: Y is additive and satisfies the nonincreasing returns condition if and only if it is a convex cone.

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("24.png")
 grid.raster(img)
```

#### **5.C - Profit Maximization and Cost Minimization**

What is the market behavior of the firm? **The firm's objective is to maximize its profit**. There is a vector of prices for the L goods: $p = (p_1,....,p_2) \gg 0$ and these prices are independent from the production of the firm. The firm's maximization problem is: 

\[ Max_y p y \text{s.t. } y \in Y \]

Using a transformation function to describe Y, F(.), we can equivalently state the PMP as

\[ Max_y py \text{s.t. } F(y) ≤ 0  \]

Given a production set Y, the firm's **profit function** $\pi(p)$ associates to every *p* the amount $\pi(p)$ = Max {py:y$\in$Y}, the value of the solution to the PMP. We define the firm's **supply correspondence** at p, denoted y(p), as the set of profit-maximizing vectors y(p) = {y $\in$ Y: py = $\pi$(p)}. The optimizing vector y(p) lies at the point in Y associated with the highest level of profit. In the figure below, y(p) therefore lies on the iso-profit line that intersects the production set farthest to the northeast and is therefore tangent to the boundary of Y at y(p):

```{r ,echo=FALSE}
library(png)
library(grid)
setwd("~/Dropbox/R/Site-Gabriel/public/MIT")
img <- readPNG("25.png")
 grid.raster(img)
```

When Y corresponds to a single-output technology with differentiable production function f(z), we can view the firm's decision as simply a choice over its input levels z. In this special case, we shall let the scalar p > 0 denote the price of the firm's output and the vector w $\gg$ 0 denote its input prices. The input vector $z^\ast$ maximizes profit given (p,w) if it solves:

\[ Max_{z≥0} pf(z) - wz \]

If $z^\ast$ is optimal, then the following FOC must be satisfied for l = 1,...,L - 1:

\[ p \frac{\partial f(z^\ast)}{\partial z_l} ≤ w_l \text{with equality if }z_l^\ast ≥ 0\]

**Proposition 5C1**: suppose that $\pi(.)$ is the profit function of the production set Y and that y(.) is the associated supply correspondence. Assume also that Y is closed and satisfies the free disposal property. Then:

i) $\pi(.)$ is homogenenous of degree one.

ii) $\pi(.)$ is convex.

iii) If Y is convex then Y = {y $\in \mathbb{R}^L$: py ≤ $\pi(p)$ for all p $\gg$ 0 }

iv) y(.) is homogeneous of degree zero.

v) If Y is convex, then y(p) is a convex set for all p. Moreover, if Y is strictly convex, then y(p) is single-valued (if nonempty).

vi) (Hotelling's lemma) if y($\hat{p}$) consists of a single point, then $\pi(.)$ is differentiable at $\hat{p}$ and $\triangledown \pi (\hat{p}) = y(\hat{p})$.

vii) If y(.) is a function differentiable at $\hat{p}$, then Dy($\hat{p}$) = $D^2 \pi (\hat{p})$ is a symmetric and positive semidefinite matrix with Dy($\hat{p}$)$\hat{p}$ = 0.

**Law of Supply**: quantities respond in the same direction as price changes: $(p-p') (y - y') ≥ 0$. 

##### **Cost Minimization**

Cost minimization is a necessary condition for profit maximization. This leads to another study: the cost minimization problem. The CMP is:

\[ Min_{z ≥ 0} wz \text{ s.t. } f(z) ≥ q\]

The optimized value of the CMP is given by the **cost function** c(w,q). The corresponding optimizing set of input choices is the **conditional factor demand correspondence** and is denoted by z(w,q). 

**Proposition 5C2**: suppose that c(w,q) is the cost function of a single-output technology Y with production function f(.) and that z(w,q) is the associated factor demand correspondence. Assume also that Y is closed and satisfies the free disposal property. Then:

i)

ii)

iii)

iv)

v)

vi)

vii)

viii)

ix)

Using the cost function, we can now restate the firm's problem of determining its profit-maximizing production level as:

\[ Max_{q≥0} pq - c(w,q) \]

The necessary first-order condition for $q^\ast$ to be profit maximizing is then

\[ p - \frac{\partial c(w,q^\ast)}{\partial q} ≤ 0 \text{ with equality if q}^\ast > 0\]

In words, at an interior optimum (if $q^\ast$ > 0), *price equals margianl cost*. If c(w,q) is convex in q, then the first-order conditions (5C6) is also sufficient for $q^\ast$ to be the firm's optimal output level. 

### **Chapter 10 - Competitive Markets**

#### **10.B - Pareto Optimality and Competitive Equilibria**

#### **10.C - Partial Equilibrium Competitive Analysis**

#### **10.D - The Fundamental Welfare Theorems in a Partial Equilibrium Context**

#### **10.E - Welfare Analysis in the Partial Equilibrium Model**

#### **10.F - Free-Entry and Long-Run Competitive Equilibria**

#### **10.G - Concluding Remarks**

### **Chapter 11 - Externalities and Public Goods**

#### **11.B - A Simple Bilateral Externality**

#### **11.C - Public Goods**

#### **11.D - Multilateral Externalities**

#### **11.E - Private Information and Second-Best Solutions**

### **Chapter 12 - Market Power**

#### **12.B - Monopoly Pricing**

### **Chapter 15 - General Equilibrium Theory: Some Examples**

#### **15.B - Pure Exchange: The Edgeworth Box**

#### **15.C - The One-Consumer, One-Producer Economy**

#### **15.D - 2x2 Production Model**

#### **15.E - General Versus Partial Equilibrium Theory**

### **Chapter 16 - Equilibrium and Its Basic Welfare Properties**

#### **16.B - The Basic Model and Definitions**

#### **16.C - The First Fundamental Theorem of Welfare Economics**

#### **16.D - The Second Fundamental Theorem of Welfare Economics**

#### **16.E - Pareto Optimality and Social Welfare Optima**

#### **16.F - First-Order Conditions for Pareto Optimality**

#### **16.G - Some Applications**

## **Krebs Takeaways**{.tabset}

### 1

#### 1) Choice Preference and Utility

Demand and supply derive from choices. Choices can be made by firms or individual consumers. Basic framework:

- *X*: a set of possible objects that might be chosen and an individual, the consumer, who does the choosing. 

- $\mathcal{A}$ collection of nonempty subsets of X/

- *A*: typical element of $\mathcal{A}$, A $\subset$ X.

- c(A): consumer choices.

- c: a choice function whose domain is $\mathcal{A}$ and range is the set of subsets of X.

- Commodity bundle: x = $\{x_1,...,x_n\} \in R_+^k$ where $R_+^k$ = $\{x \in R^k: x ≥ 0\}$.

- Prices: $p_i$ for the commodities so that $p = \{p_1,...,p_n\}$ is the price vector. 

- Income: *y* denotes the income of the consumer.

The story is that consumer chooses one element of A. c(A) is a **subset** of A, not a member/element of A. This allows for the consumer to be happy with more than one element of A, which are listed by c(A). The consumer could choose "*x* and nothing else", which would lead to writing c(A) = {x}, a singleton set. If the consumer says: "I'm happy with either x or y", we write c(A) = {x,y}. 

A [**model of consumer choice**](https://en.wikipedia.org/wiki/Consumer_choice) consists of some set X of possible objects of choice, a collection $\mathcal{A}$ of nonempty sets of X, and a choice function *c* whose domain is $\mathcal{A}$ and whose range is the set of subsets of X, with the sole restriction that c(A) $\subseteq$ A. 

Given the commodity bundle, prices and income can be expressed by: $\{x \in R_+^k: p x ≤ y \}$. A model of consumer choice in this context is then a choice function that says which bundles the consumer would be willing to accept, as a function of the prices of the goods *p* and her level of income *y*. 

The choices of the consumer are assumed to be *coherent* and in accord with *utility maximization* for some [**utility function**](https://en.wikipedia.org/wiki/Utility)(u). There is a function *u*: X $\rightarrow$ R, s.t. that $\forall$: 

\[ c(A) = \{x \in A: u(x) ≥ u(y) \forall y \in A \} \]

A third sort of coherence involves a *preference relation* over X. A preference relation expresses the consumer's feelings between pairs of objects in X. The preference relation is denoted by $\succeq$. For every pair of x and y from X, the consumer is willing to say that either x $\succeq$ y, meaning *x* is at least as good *y*, or not. 

\[ c(A) = \{x \in A: x \succeq y \forall y \in A \} \]



### 2 

#### 2 Structutal Properties of Preferences and Utility Functions



##### 2.1 Monotonicity



### 3


